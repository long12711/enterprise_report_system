# ç°ä»£ä¼ä¸šåˆ¶åº¦æŒ‡æ•°è¯„ä»·é—®å·ç³»ç»Ÿ - å®ç°æ€»ç»“

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ä¼ä¸šé—®å·ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒä» Word æ–‡æ¡£å¯¼å…¥é—®å·é¢˜ç›®ã€ä¼ä¸šåœ¨çº¿å¡«å†™é—®å·ã€ä¸Šä¼ è¡¥å……æ–‡ä»¶ã€ä»¥åŠæ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“çš„å…¨æµç¨‹ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. é—®å·å¯¼å…¥ç®¡ç†
- âœ… ä» Word æ–‡æ¡£è‡ªåŠ¨æå–é—®å·é¢˜ç›®
- âœ… æ”¯æŒåˆçº§ã€ä¸­çº§ã€é«˜çº§ä¸‰ä¸ªçº§åˆ«çš„é—®å·
- âœ… è‡ªåŠ¨è§£æé¢˜ç›®çš„å„ä¸ªå±æ€§ï¼ˆæŒ‡æ ‡ã€ç±»å‹ã€åˆ†å€¼ç­‰ï¼‰
- âœ… æ”¯æŒæ‰¹é‡å¯¼å…¥å¤šä¸ªé—®å·

### 2. ä¼ä¸šé—®å·å¡«å†™
- âœ… åœ¨çº¿é—®å·å¡«å†™ç•Œé¢
- âœ… æ”¯æŒå¤šç§é¢˜ç›®ç±»å‹ï¼ˆå•é€‰ã€å¤šé€‰ã€æ–‡æœ¬ã€æ•°å­—ç­‰ï¼‰
- âœ… å®æ—¶è¿›åº¦æ˜¾ç¤º
- âœ… è‰ç¨¿ä¿å­˜åŠŸèƒ½
- âœ… é—®å·æäº¤åŠŸèƒ½

### 3. æ–‡ä»¶ä¸Šä¼ ç®¡ç†
- âœ… æ”¯æŒä¸Šä¼ è¡¥å……æ•°æ®/è¯´æ˜æ–‡ä»¶
- âœ… æ–‡ä»¶ç±»å‹å’Œå¤§å°éªŒè¯
- âœ… å®‰å…¨çš„æ–‡ä»¶å­˜å‚¨
- âœ… æ–‡ä»¶åˆ—è¡¨ç®¡ç†

### 4. æ•°æ®å­˜å‚¨
- âœ… JSON æ•°æ®åº“å­˜å‚¨ï¼ˆå¿«é€Ÿå¼€å‘ï¼‰
- âœ… MySQL æ•°æ®åº“æ”¯æŒï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- âœ… é—®å·ã€é—®é¢˜ã€æäº¤ã€ç­”æ¡ˆã€é™„ä»¶çš„å®Œæ•´å­˜å‚¨

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
project_root/
â”œâ”€â”€ æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ docx_questionnaire_importer.py      # Word æ–‡æ¡£å¯¼å…¥
â”‚   â”œâ”€â”€ questionnaire_management_api.py     # é—®å·ç®¡ç† API
â”‚   â”œâ”€â”€ file_upload_handler.py              # æ–‡ä»¶ä¸Šä¼ å¤„ç†
â”‚   â””â”€â”€ test_questionnaire_import.py        # æµ‹è¯•è„šæœ¬
â”‚
â”œâ”€â”€ å‰ç«¯
â”‚   â””â”€â”€ templates/questionnaire_form.html   # é—®å·å¡«å†™é¡µé¢
â”‚
â”œâ”€â”€ æ•°æ®åº“
â”‚   â””â”€â”€ db/095_questionnaire_submissions.sql  # æ•°æ®åº“è¡¨å®šä¹‰
â”‚
â”œâ”€â”€ æ–‡æ¡£
â”‚   â”œâ”€â”€ QUESTIONNAIRE_IMPLEMENTATION_GUIDE.md   # è¯¦ç»†å®ç°æŒ‡å—
â”‚   â”œâ”€â”€ INTEGRATION_CHECKLIST.md                # é›†æˆæ£€æŸ¥æ¸…å•
â”‚   â””â”€â”€ QUESTIONNAIRE_SYSTEM_SUMMARY.md         # æœ¬æ–‡æ¡£
â”‚
â”œâ”€â”€ åº”ç”¨
â”‚   â””â”€â”€ app.py                              # ä¸»åº”ç”¨ï¼ˆå·²é›†æˆï¼‰
â”‚
â””â”€â”€ å­˜å‚¨
    â””â”€â”€ storage/
        â”œâ”€â”€ questionnaires.json             # é—®å·æ•°æ®åº“
        â””â”€â”€ questionnaire_uploads/          # ä¸Šä¼ çš„æ–‡ä»¶
```

## ğŸ”§ æŠ€æœ¯æ¶æ„

### åç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Flask åº”ç”¨ (app.py)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é—®å·ç®¡ç† API (questionnaire_bp)        â”‚
â”‚  â”œâ”€â”€ å¯¼å…¥æ¥å£                           â”‚
â”‚  â”œâ”€â”€ æŸ¥è¯¢æ¥å£                           â”‚
â”‚  â”œâ”€â”€ å¡«å†™æ¥å£                           â”‚
â”‚  â””â”€â”€ ä¸Šä¼ æ¥å£                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡é€»è¾‘å±‚                             â”‚
â”‚  â”œâ”€â”€ DocxQuestionnaireImporter          â”‚
â”‚  â”œâ”€â”€ FileUploadHandler                  â”‚
â”‚  â””â”€â”€ æ•°æ®éªŒè¯                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å±‚                                 â”‚
â”‚  â”œâ”€â”€ JSON æ•°æ®åº“ (questionnaires.json)  â”‚
â”‚  â”œâ”€â”€ MySQL æ•°æ®åº“                       â”‚
â”‚  â””â”€â”€ æ–‡ä»¶ç³»ç»Ÿ (storage/)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‰ç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    é—®å·å¡«å†™é¡µé¢ (questionnaire_form.html)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UI å±‚                                  â”‚
â”‚  â”œâ”€â”€ é—®å·çº§åˆ«é€‰æ‹©                       â”‚
â”‚  â”œâ”€â”€ é—®é¢˜åŠ¨æ€æ¸²æŸ“                       â”‚
â”‚  â”œâ”€â”€ è¿›åº¦æ¡æ˜¾ç¤º                         â”‚
â”‚  â””â”€â”€ æ“ä½œæŒ‰é’®                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡é€»è¾‘å±‚ (JavaScript)                â”‚
â”‚  â”œâ”€â”€ é—®å·åŠ è½½                           â”‚
â”‚  â”œâ”€â”€ ç­”æ¡ˆæ”¶é›†                           â”‚
â”‚  â”œâ”€â”€ æ–‡ä»¶ä¸Šä¼                            â”‚
â”‚  â””â”€â”€ æ•°æ®éªŒè¯                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API è°ƒç”¨å±‚                             â”‚
â”‚  â”œâ”€â”€ é—®å·æŸ¥è¯¢ API                       â”‚
â”‚  â”œâ”€â”€ æäº¤åˆ›å»º API                       â”‚
â”‚  â”œâ”€â”€ ç­”æ¡ˆä¿å­˜ API                       â”‚
â”‚  â”œâ”€â”€ é—®å·æäº¤ API                       â”‚
â”‚  â””â”€â”€ æ–‡ä»¶ä¸Šä¼  API                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š æ•°æ®æµ

### é—®å·å¯¼å…¥æµç¨‹

```
Word æ–‡æ¡£
    â†“
DocxQuestionnaireImporter.import_questionnaire()
    â†“
è§£æè¡¨æ ¼æ•°æ®
    â†“
åˆ›å»ºé—®å·å’Œé—®é¢˜å¯¹è±¡
    â†“
ä¿å­˜åˆ° JSON æ•°æ®åº“
    â†“
ä¿å­˜åˆ° MySQL æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰
    â†“
å¯¼å…¥å®Œæˆ
```

### ä¼ä¸šå¡«å†™é—®å·æµç¨‹

```
ä¼ä¸šè®¿é—® /questionnaire/form
    â†“
é€‰æ‹©é—®å·çº§åˆ«
    â†“
è°ƒç”¨ GET /api/questionnaire/survey/level/<level>
    â†“
è°ƒç”¨ POST /api/questionnaire/submission/create
    â†“
å‰ç«¯æ¸²æŸ“é—®å·è¡¨å•
    â†“
ä¼ä¸šå¡«å†™ç­”æ¡ˆ
    â†“
ä¼ä¸šä¸Šä¼ æ–‡ä»¶ï¼ˆå¦‚éœ€è¦ï¼‰
    â†“
ä¼ä¸šç‚¹å‡»"æäº¤é—®å·"
    â†“
è°ƒç”¨ POST /api/questionnaire/submission/<id>/submit
    â†“
ä¿å­˜ç­”æ¡ˆå’Œé™„ä»¶åˆ°æ•°æ®åº“
    â†“
æ˜¾ç¤ºæˆåŠŸæç¤º
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install python-docx mysql-connector-python
```

### 2. å¯¼å…¥é—®å·

```python
from docx_questionnaire_importer import DocxQuestionnaireImporter

importer = DocxQuestionnaireImporter()
docx_dir = r'D:\xwechat_files\wxid_nfuq3yq5zb4x22_dcf3\msg\file\2025-12'
result = importer.import_all_questionnaires(docx_dir)
```

### 3. å¯åŠ¨åº”ç”¨

```bash
python run_app.py
```

### 4. è®¿é—®é—®å·é¡µé¢

```
http://localhost:5000/questionnaire/form
```

## [object Object] æ¥å£åˆ—è¡¨

### å¯¼å…¥æ¥å£

| æ–¹æ³• | ç«¯ç‚¹ | åŠŸèƒ½ |
|------|------|------|
| POST | `/api/questionnaire/import` | å¯¼å…¥å•ä¸ªé—®å· |
| POST | `/api/questionnaire/import-batch` | æ‰¹é‡å¯¼å…¥é—®å· |

### æŸ¥è¯¢æ¥å£

| æ–¹æ³• | ç«¯ç‚¹ | åŠŸèƒ½ |
|------|------|------|
| GET | `/api/questionnaire/surveys` | è·å–æ‰€æœ‰é—®å· |
| GET | `/api/questionnaire/survey/<id>` | è·å–é—®å·è¯¦æƒ… |
| GET | `/api/questionnaire/survey/level/<level>` | æŒ‰çº§åˆ«è·å–é—®å· |

### å¡«å†™æ¥å£

| æ–¹æ³• | ç«¯ç‚¹ | åŠŸèƒ½ |
|------|------|------|
| POST | `/api/questionnaire/submission/create` | åˆ›å»ºé—®å·æäº¤ |
| GET | `/api/questionnaire/submission/<id>` | è·å–æäº¤è¯¦æƒ… |
| POST | `/api/questionnaire/submission/<id>/save` | ä¿å­˜è‰ç¨¿ |
| POST | `/api/questionnaire/submission/<id>/submit` | æäº¤é—®å· |

### ä¸Šä¼ æ¥å£

| æ–¹æ³• | ç«¯ç‚¹ | åŠŸèƒ½ |
|------|------|------|
| POST | `/api/questionnaire/submission/<id>/upload` | ä¸Šä¼ é™„ä»¶ |

## ğŸ’¾ æ•°æ®åº“è®¾è®¡

### JSON æ•°æ®åº“ç»“æ„

```json
{
  "surveys": [
    {
      "id": "uuid",
      "name": "é—®å·åç§°",
      "level": "åˆçº§|ä¸­çº§|é«˜çº§",
      "description": "æè¿°",
      "total_questions": 100,
      "status": "active",
      "created_at": "ISO 8601 æ—¶é—´"
    }
  ],
  "questions": [
    {
      "id": "uuid",
      "survey_id": "uuid",
      "seq_no": "1",
      "level1": "ä¸€çº§æŒ‡æ ‡",
      "level2": "äºŒçº§æŒ‡æ ‡",
      "question_text": "é—®é¢˜æ–‡æœ¬",
      "question_type": "åˆè§„ç±»|æœ‰æ•ˆæ€§|æ•°å­—|æ–‡æœ¬",
      "score": "10",
      "applicable": "æ‰€æœ‰ä¼ä¸š",
      "remarks": "å¤‡æ³¨",
      "requires_file": true
    }
  ],
  "submissions": [
    {
      "id": "uuid",
      "enterprise_id": "uuid",
      "survey_id": "uuid",
      "survey_level": "åˆçº§",
      "status": "draft|submitted|reviewed",
      "created_at": "ISO 8601 æ—¶é—´"
    }
  ],
  "answers": {
    "submission_id": {
      "question_id": "answer_value"
    }
  },
  "attachments": {
    "submission_id": [
      {
        "id": "uuid",
        "question_id": "uuid",
        "file_name": "åŸå§‹æ–‡ä»¶å",
        "file_path": "å­˜å‚¨è·¯å¾„",
        "file_size": 1024,
        "upload_time": "ISO 8601 æ—¶é—´"
      }
    ]
  }
}
```

### MySQL æ•°æ®åº“è¡¨

- `questionnaire_templates` - é—®å·æ¨¡æ¿
- `questionnaire_template_questions` - æ¨¡æ¿é—®é¢˜
- `questionnaire_submissions` - é—®å·æäº¤è®°å½•
- `questionnaire_answers` - é—®å·ç­”æ¡ˆ
- `questionnaire_attachments` - é—®å·é™„ä»¶

## ğŸ” å®‰å…¨ç‰¹æ€§

- âœ… æ–‡ä»¶ç±»å‹éªŒè¯ï¼ˆç™½åå•ï¼‰
- âœ… æ–‡ä»¶å¤§å°é™åˆ¶ï¼ˆ100MBï¼‰
- âœ… æ–‡ä»¶åå®‰å…¨å¤„ç†ï¼ˆUUID + åŸå§‹åç§°ï¼‰
- âœ… è®¿é—®æ§åˆ¶ï¼ˆç™»å½•æ£€æŸ¥ï¼‰
- âœ… æƒé™éªŒè¯ï¼ˆä¼ä¸šç”¨æˆ·æ£€æŸ¥ï¼‰
- âœ… æ•°æ®éš”ç¦»ï¼ˆæ¯ä¸ªæäº¤å•ç‹¬å­˜å‚¨ï¼‰

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

- é—®å·å¯¼å…¥ï¼š< 5 ç§’ï¼ˆ100 ä¸ªé—®é¢˜ï¼‰
- é—®å·åŠ è½½ï¼š< 1 ç§’
- æ–‡ä»¶ä¸Šä¼ ï¼šå–å†³äºæ–‡ä»¶å¤§å°ï¼ˆæœ€å¤§ 100MBï¼‰
- æ•°æ®åº“æŸ¥è¯¢ï¼š< 100ms

## ğŸ§ª æµ‹è¯•

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½ï¼š

```bash
python test_questionnaire_import.py
```

æµ‹è¯•å†…å®¹ï¼š
- âœ… Word æ–‡æ¡£å¯¼å…¥
- âœ… é—®å·æ•°æ®éªŒè¯
- âœ… API æ¥å£æµ‹è¯•
- âœ… æ•°æ®ç»“æ„éªŒè¯
- âœ… æ ·æœ¬æ•°æ®æ˜¾ç¤º

## ğŸ“š æ–‡æ¡£

- **å®ç°æŒ‡å—**: `QUESTIONNAIRE_IMPLEMENTATION_GUIDE.md`
  - è¯¦ç»†çš„ç³»ç»Ÿæ¶æ„
  - æ¨¡å—è¯´æ˜
  - API æ–‡æ¡£
  - ä½¿ç”¨ç¤ºä¾‹

- **é›†æˆæ¸…å•**: `INTEGRATION_CHECKLIST.md`
  - é›†æˆæ­¥éª¤
  - éªŒè¯æ¸…å•
  - å¸¸è§é—®é¢˜
  - å›æ»šè®¡åˆ’

- **æœ¬æ–‡æ¡£**: `QUESTIONNAIRE_SYSTEM_SUMMARY.md`
  - é¡¹ç›®æ¦‚è¿°
  - å¿«é€Ÿå¼€å§‹
  - æŠ€æœ¯æ¶æ„

## ğŸ”„ æ‰©å±•åŠŸèƒ½

å¯ä»¥æ·»åŠ çš„åŠŸèƒ½ï¼š

1. **é—®å·è¯„åˆ†**
   - è‡ªåŠ¨è®¡ç®—é—®å·å¾—åˆ†
   - ç”Ÿæˆè¯„åˆ†æŠ¥å‘Š

2. **æ•°æ®åˆ†æ**
   - å¯¹æ¯”åˆ†æ
   - è¶‹åŠ¿åˆ†æ
   - æ•°æ®å¯è§†åŒ–

3. **æŠ¥å‘Šç”Ÿæˆ**
   - ç”Ÿæˆ PDF æŠ¥å‘Š
   - ç”Ÿæˆ Excel æŠ¥å‘Š
   - é‚®ä»¶å‘é€

4. **æƒé™ç®¡ç†**
   - è§’è‰²æƒé™æ§åˆ¶
   - å®¡æ ¸æµç¨‹
   - æ•°æ®å¯¼å‡ºæƒé™

5. **é€šçŸ¥ç³»ç»Ÿ**
   - é—®å·æäº¤é€šçŸ¥
   - å®¡æ ¸ç»“æœé€šçŸ¥
   - å®šæ—¶æé†’

## ğŸ› å·²çŸ¥é—®é¢˜

- æš‚æ— å·²çŸ¥é—®é¢˜

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹å®ç°æŒ‡å—ï¼š`QUESTIONNAIRE_IMPLEMENTATION_GUIDE.md`
2. æŸ¥çœ‹é›†æˆæ¸…å•ï¼š`INTEGRATION_CHECKLIST.md`
3. è¿è¡Œæµ‹è¯•è„šæœ¬ï¼š`python test_questionnaire_import.py`
4. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š`storage/logs/`

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (2025-12-02)

- âœ… åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… å®ç° Word æ–‡æ¡£å¯¼å…¥
- âœ… å®ç°é—®å·ç®¡ç† API
- âœ… å®ç°å‰ç«¯é—®å·å¡«å†™é¡µé¢
- âœ… å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- âœ… å®Œæˆæ–‡æ¡£å’Œæµ‹è¯•

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä¸ºå†…éƒ¨é¡¹ç›®ï¼Œä»…ä¾›å—å¼€å¤§å­¦ä½¿ç”¨ã€‚

## ğŸ‘¥ è´¡çŒ®è€…

- ç³»ç»Ÿè®¾è®¡å’Œå®ç°ï¼šAI åŠ©æ‰‹
- éœ€æ±‚æå‡ºï¼šç”¨æˆ·

---

**æœ€åæ›´æ–°**: 2025-12-02
**ç‰ˆæœ¬**: 1.0
**çŠ¶æ€**: å·²å®Œæˆï¼Œå¾…éƒ¨ç½²

