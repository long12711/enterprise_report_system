# 南开大学现代企业制度指数评价问卷生成器 - 使用指南

## 📋 项目概述

本系统根据**南开大学现代企业制度指数评价体系**自动生成三级调查问卷（初级、中级、高级），每个问题包含：
- ✅ **选择题**（自动从打分标准解析）
- ✅ **填空题**（补充数据/说明）
- ✅ **佐证材料要求**

## 🎯 功能特点

### 1. 三级问卷体系
- **初级问卷（基础指标）**：64个问题，适用于所有民营企业
- **中级问卷（鼓励指标）**：52个问题，适用于治理较规范的企业
- **高级问卷（拔高指标）**：42个问题，适用于治理优秀的企业

### 2. 智能选项生成
系统自动从打分标准解析生成选项：
- **完成项数型**：`A. 完成X项 B. 完成Y项 C. 均未完成`
- **是否型**：`A. 是 B. 否`
- **时间范围型**：`A. 近X年连续满足 B. 部分满足 C. 未满足`
- **行业对比型**：`A. 达到行业平均值 B. 接近 C. 低于`

### 3. 完整的问卷结构
每个问题包含8列信息：
| 列名 | 说明 |
|------|------|
| 序号 | 问题编号 |
| 一级指标 | 治理方向性/规范性/安全性/科学性/社会性/有效性 |
| 二级指标 | 具体评价维度 |
| 三级指标 | 具体评价项目 |
| 打分标准 | 原始评分标准 |
| 选项 | 自动生成的选择题选项 |
| 补充数据/说明 | 需要填写的具体数据 |
| 佐证材料 | 需要提交的证明材料 |

## 🚀 快速开始

### 方法一：命令行使用（推荐）

```bash
# 1. 进入问卷生成器目录
cd survey_generator

# 2. 运行生成器（自动生成三个级别）
python nankai_excel_generator.py
```

**输出结果**：
```
[OK] 成功加载指标数据：
  初级: 64 条
  中级: 52 条
  高级: 42 条

开始生成问卷...

[OK] 成功生成初级问卷: output/questionnaires\调查问卷_初级_20251130_224041.xlsx
[OK] 成功生成中级问卷: output/questionnaires\调查问卷_中级_20251130_224041.xlsx
[OK] 成功生成高级问卷: output/questionnaires\调查问卷_高级_20251130_224041.xlsx
```

### 方法二：Python代码调用

```python
from survey_generator.nankai_excel_generator import NankaiExcelGenerator

# 创建生成器
excel_path = "report_generator/南开大学-现代企业制度指数评价体系初稿2025.10.22（单独指标）(1).xlsx"
generator = NankaiExcelGenerator(excel_path)

# 生成单个级别
generator.generate_questionnaire('初级', 'output/初级问卷.xlsx')

# 或生成所有级别
results = generator.generate_all_questionnaires('output/questionnaires')
```

## 📁 文件结构

```
enterprise_report_system/
├── survey_generator/
│   ├── nankai_excel_generator.py      # Excel格式生成器（当前可用）
│   ├── nankai_questionnaire_generator.py  # Word格式生成器（需python-docx）
│   ├── README_NANKAI.md               # 技术文档
│   └── output/
│       └── questionnaires/            # 生成的问卷文件
│           ├── 调查问卷_初级_*.xlsx
│           ├── 调查问卷_中级_*.xlsx
│           └── 调查问卷_高级_*.xlsx
│
└── report_generator/
    └── 南开大学-现代企业制度指数评价体系初稿2025.10.22（单独指标）(1).xlsx
```

## 📊 生成的问卷示例

### 初级问卷示例（部分）

| 序号 | 一级指标 | 二级指标 | 三级指标 | 选项 | 补充数据/说明 | 佐证材料 |
|------|----------|----------|----------|------|---------------|----------|
| 1 | 治理方向性 | 党组织建设 | 规范党组织建设 | A. 是 B. 否 | | 能证明党组织或者联合组建党组织的文件或记录 |
| 2 | 治理方向性 | 党组织建设 | 执行党的组织生活制度 | A. 全部完成 B. 部分完成 C. 均未完成 | | 三会一课开展记录 |
| 9 | 治理规范性 | 权属清晰 | 产权归属清晰 | A. 全部完成 B. 部分完成 C. 均未完成 | | 提供公司章程、股东协议、股东会决议、工商登记基本信息 |

## 🔧 技术说明

### 依赖项
```
pandas>=2.0.0
openpyxl>=3.1.0
python-docx>=1.0.0  # Word格式需要
```

### 安装依赖
```bash
pip install pandas openpyxl python-docx
```

### 选项解析逻辑

生成器会智能解析打分标准中的关键词：

1. **"全部完成"** → `A. 全部完成 B. 部分完成 C. 均未完成`
2. **"完成两项"** → `A. 完成两项 B. 仅完成 1 项 C. 均未完成`
3. **"完成三项"** → `A. 完成三项 B. 完成 2 项 C. 完成 1 项 D. 均未完成`
4. **"达到行业平均值"** → `A. 达到行业平均值 B. 接近 C. 低于`
5. **"建立/制定/设立"** → `A. 是 B. 否`

## 📝 使用场景

### 场景1：企业自评
企业可以根据自身规模和治理水平选择相应级别的问卷进行自评：
- 初创企业 → 初级问卷
- 成长型企业 → 中级问卷
- 成熟企业 → 高级问卷

### 场景2：工商联评估
工商联可以使用生成的问卷对企业进行标准化评估，确保评价的一致性和公平性。

### 场景3：批量生成
可以一次性生成所有三个级别的问卷，供不同类型企业使用。

## ⚠️ 注意事项

1. **Excel文件路径**：确保南开大学指标体系Excel文件路径正确
2. **输出目录**：系统会自动创建不存在的输出目录
3. **文件命名**：自动添加时间戳避免文件覆盖
4. **编码问题**：Excel格式支持中文，无编码问题

## 🔄 版本说明

### 当前版本：v1.0.0

**已实现功能**：
- ✅ Excel格式问卷生成
- ✅ 三级问卷体系
- ✅ 智能选项解析
- ✅ 完整的佐证材料要求
- ✅ 批量生成功能

**计划功能**：
- ⏳ Word格式问卷生成（需安装python-docx）
- ⏳ 在线填写功能集成
- ⏳ 自动评分功能

## 📞 技术支持

如遇问题，请检查：
1. Python版本（建议3.8+）
2. 依赖包是否正确安装
3. Excel文件路径是否正确
4. 输出目录是否有写入权限

## 📈 统计信息

- **初级问卷**：64个问题，涵盖6大一级指标
- **中级问卷**：52个问题，进阶评价标准
- **高级问卷**：42个问题，卓越治理标准
- **总计**：158个评价指标

---

**生成时间**：2025-11-30  
**版本**：v1.0.0  
**维护者**：企业报告系统开发团队