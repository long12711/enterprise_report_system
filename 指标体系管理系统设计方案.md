# 指标体系管理系统设计方案

## 一、系统概述

实现一个完整的指标体系管理系统，支持对指标、评分规则、问卷版本和报告模板进行全面管理。

## 二、核心功能模块

### 2.1 指标体系管理

**功能**：对指标体系信息进行增删改查

**数据结构**：
```json
{
  "id": "indicator_001",
  "level1": "治理方向性",
  "level2": "党组织建设",
  "level3": "规范党组织建设",
  "question": "企业是否建立党组织？",
  "score_value": "1",
  "evidence_required": "党组织成立文件",
  "applicable_levels": ["初级", "中级", "高级"],
  "status": "active",
  "created_at": "2024-12-01T00:00:00Z",
  "updated_at": "2024-12-01T00:00:00Z"
}
```

**API接口**：
- `GET /api/admin/indicators` - 获取指标列表
- `POST /api/admin/indicators` - 创建新指标
- `PUT /api/admin/indicators/:id` - 更新指标
- `DELETE /api/admin/indicators/:id` - 删除指标

### 2.2 评分规则管理

**功能**：按初级、中级、高级分类管理评分规则

**评分规则类型**：
1. 二选一（binary）：是/否
2. 全部完成（all_required）：必须完成所有项
3. 多项计分（multi_item）：按完成数量计分
4. 负向计分（negative）：扣分项
5. 分级计分（graded）：按完成程度分级

**API接口**：
- `GET /api/admin/scoring-rules/by-level/:level` - 按级别获取规则
- `POST /api/admin/scoring-rules` - 创建新规则
- `PUT /api/admin/scoring-rules/:id` - 更新规则
- `DELETE /api/admin/scoring-rules/:id` - 删除规则

### 2.3 问卷版本管理

**功能**：问卷设计、版本控制、历史版本保存、状态管理

**问卷状态**：
- `draft` - 草稿（编辑中）
- `active` - 使用中（当前版本）
- `archived` - 已归档（历史版本）
- `closed` - 已关闭（停用）

**API接口**：
- `GET /api/admin/questionnaires` - 获取问卷列表
- `GET /api/admin/questionnaires/:id/versions` - 获取版本历史
- `POST /api/admin/questionnaires/:id/publish` - 发布问卷
- `POST /api/admin/questionnaires/:id/clone` - 克隆新版本

### 2.4 报告模板管理

**功能**：管理报告模板，确保格式稳定

**API接口**：
- `GET /api/admin/templates` - 获取模板列表
- `POST /api/admin/templates` - 创建新模板
- `PUT /api/admin/templates/:id` - 更新模板

## 三、数据库设计

### 3.1 指标表（indicators）
- id, level1, level2, level3, question, score_value, evidence_required
- applicable_levels, status, created_at, updated_at

### 3.2 评分规则表（scoring_rules）
- id, indicator_id, level, rule_type, rule_text, scoring_logic
- max_score, status, created_at, updated_at

### 3.3 问卷版本表（questionnaire_versions）
- id, name, level, version, status, description
- indicators, total_questions, max_score
- created_by, created_at, published_at, archived_at

### 3.4 报告模板表（report_templates）
- id, name, type, version, status, structure
- created_at, updated_at

## 四、实施计划

### 阶段一：数据库和后端API（1-2周）
1. 设计数据库表结构
2. 创建数据模型
3. 实现CRUD API接口
4. 编写单元测试

### 阶段二：管理后台界面（2-3周）
1. 设计UI界面
2. 实现指标管理页面
3. 实现评分规则管理页面
4. 实现问卷版本管理页面
5. 实现报告模板管理页面

### 阶段三：集成和测试（1周）
1. 系统集成测试
2. 用户验收测试
3. 文档编写
4. 部署上线

## 五、技术栈

- **后端**：Python Flask
- **数据库**：SQLite/MySQL
- **前端**：HTML + JavaScript + Bootstrap
- **ORM**：SQLAlchemy

## 六、下一步行动

1. 创建数据库模型文件
2. 实现基础CRUD API
3. 创建管理后台页面
4. 编写测试用例
5. 完善文档

---

**文档版本**: v1.0  
**创建日期**: 2024-12-01  
**维护者**: 系统开发团队