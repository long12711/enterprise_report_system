# 📧 专业报告查看和发送完整指南

## 🎯 快速操作（3步完成）

### 第一步：生成专业报告
双击运行：
```
生成专业报告.bat
```
选择 `1` → 报告自动生成并打开

### 第二步：查看报告
Word文档会自动打开，您可以查看专业版报告

### 第三步：发送给企业
双击运行：
```
发送专业报告.bat
```
选择要发送的企业 → 自动发送邮件

---

## 📍 专业报告在哪里？

### 自动保存位置
```
D:\Claude Code\enterprise_report_system\
    ├── XX公司_现代制度评价报告_20250117.docx  ← 专业版报告
    ├── YY公司_现代制度评价报告_20250117.docx
    └── ...
```

### 文件名格式
```
{企业名称}_现代制度评价报告_{时间戳}.docx
```

---

## 📧 如何发送给企业？（4种方法）

### ⭐ 方法1：一键发送工具（推荐）

**批量发送所有企业**：
1. 双击 `发送专业报告.bat`
2. 选择 `1. 批量发送（所有企业）`
3. 输入 `y` 确认
4. 系统自动为每家企业生成报告并发送邮件

**发送单个企业**：
1. 双击 `发送专业报告.bat`
2. 选择 `2. 发送单个企业`
3. 输入企业序号
4. 确认发送

---

### 方法2：通过Web管理后台

1. 启动系统：`python app.py` 或双击 `run.bat`
2. 访问：http://localhost:5000/admin/login
3. 登录（admin / admin123）
4. 进入"问卷提交管理"
5. 点击企业旁边的"发送邮件"按钮

---

### 方法3：手动发送

1. 找到生成的报告文件（在项目根目录）
2. 打开您的邮箱客户端
3. 新建邮件，添加报告作为附件
4. 发送给企业联系人邮箱

**邮件模板示例**：
```
主题：【企业现代制度评价】贵司评价报告

尊敬的XX企业负责人：

感谢贵司参与现代企业制度指数评价工作。现将评价报告发送给您，
请查收附件。

报告对贵司的制度建设情况进行了全面评估，并提出了针对性的改
进建议，供贵司参考。

如有疑问，请随时联系我们。

此致
敬礼

评价工作组
{日期}
```

---

### 方法4：Python命令发送

```python
python send_professional_reports.py
```

---

## 🔧 自动发送设置

### 配置邮箱（必须先配置才能自动发送）

1. **通过Web界面配置**：
   - 登录管理后台
   - 进入"邮件设置"
   - 填写SMTP配置
   - 测试邮件发送

2. **配置文件位置**：
   - 修改 `notification_service.py` 中的邮箱配置

### 常用邮箱SMTP设置

#### QQ邮箱
```
SMTP服务器: smtp.qq.com
端口: 587 或 465
密码: 使用授权码（非登录密码）
```

#### 163邮箱
```
SMTP服务器: smtp.163.com
端口: 465
密码: 使用授权码
```

#### 企业邮箱
```
SMTP服务器: 咨询您的IT部门
端口: 通常为587或465
密码: 邮箱密码或授权码
```

---

## 💡 发送方式对比

| 方式 | 优点 | 适用场景 |
|------|------|----------|
| **一键发送工具** | 最简单，全自动 | 批量发送、日常使用 |
| **Web后台** | 可视化操作 | 单个发送、需要查看详情 |
| **手动发送** | 灵活性高 | 特殊情况、自定义邮件内容 |
| **Python命令** | 可编程控制 | 二次开发、自动化脚本 |

---

## 📊 完整工作流程

### 流程1：在线问卷 → 自动发送
```
企业在线填写问卷
    ↓
系统自动生成专业报告
    ↓
自动发送邮件到企业邮箱
    ↓
企业收到报告
```

### 流程2：Excel上传 → 批量发送
```
管理员上传企业数据Excel
    ↓
系统批量生成专业报告
    ↓
运行"发送专业报告.bat"
    ↓
选择批量发送
    ↓
所有企业收到报告
```

### 流程3：手动生成 → 手动发送
```
运行"生成专业报告.bat"
    ↓
查看生成的Word报告
    ↓
打开邮箱客户端
    ↓
添加附件并发送
```

---

## ❓ 常见问题

### Q1: 如何查看已生成的所有报告？
**A**: 所有报告都在项目根目录下，文件名包含企业名称和时间戳

### Q2: 可以修改邮件内容吗？
**A**: 可以，修改 `notification_service.py` 中的邮件模板

### Q3: 企业没收到邮件怎么办？
**A**: 检查：
1. 邮箱地址是否正确
2. SMTP配置是否正确
3. 查看垃圾邮件文件夹
4. 使用"测试邮件"功能验证配置

### Q4: 可以同时发送Word和PDF吗？
**A**: 可以，系统默认生成Word版专业报告，如需PDF，可在代码中启用PDF生成

### Q5: 如何重新发送某个企业的报告？
**A**:
- 使用"发送专业报告.bat" → 选择"2. 发送单个企业"
- 或者手动发送已生成的报告文件

### Q6: 批量发送会覆盖之前的报告吗？
**A**: 不会，每次生成都会创建新文件（文件名包含时间戳）

### Q7: 如何自定义报告样式？
**A**: 修改 `professional_report_generator.py` 中的格式设置

---

## 🎯 最佳实践

### 建议操作流程

1. **测试阶段**：
   - 先用1-2家企业测试
   - 生成报告并查看
   - 发送测试邮件确认配置正确

2. **正式使用**：
   - 批量生成所有企业报告
   - 查看几份报告确认质量
   - 批量发送邮件

3. **后续跟进**：
   - 保存所有生成的报告文件
   - 建立发送记录表
   - 及时回复企业咨询

---

## 📞 技术支持

如遇问题，请检查：
1. `submissions/` 文件夹中是否有Excel文件
2. 邮箱配置是否正确
3. 企业是否提供了邮箱地址
4. 查看终端输出的错误信息

---

**快速开始**：
1. 双击 `生成专业报告.bat` → 生成报告
2. 双击 `发送专业报告.bat` → 发送给企业

就这么简单！ 🎉
