# æŠ¥å‘Šæ¨¡æ¿å¢å¼ºæ–¹æ¡ˆ - è¡Œä¸šå¯¹æ¯”ä¸æ™ºèƒ½æ”¹è¿›å»ºè®®

**ç›®æ ‡**: åœ¨ç°æœ‰æŠ¥å‘ŠåŸºç¡€ä¸Šå¢åŠ è¡Œä¸šå¯¹æ¯”åˆ†æå’Œæ™ºèƒ½æ”¹è¿›å»ºè®®

---

## ğŸ“Š å½“å‰æŠ¥å‘ŠåŠŸèƒ½åˆ†æ

### âœ… å·²å®ç°åŠŸèƒ½ï¼ˆnankai_report_generator.pyï¼‰

```python
å½“å‰æŠ¥å‘ŠåŒ…å«8ä¸ªéƒ¨åˆ†:
1. âœ… å°é¢ - ä¼ä¸šåç§°ã€çº§åˆ«ã€å¾—åˆ†
2. âœ… æ‰§è¡Œæ‘˜è¦ - è¯„ä»·ç»“è®ºã€ä¼ä¸šæ¦‚å†µã€äº®ç‚¹é—®é¢˜
3. âœ… ä¼ä¸šåŸºæœ¬ä¿¡æ¯ - 6ä¸ªåŸºæœ¬å­—æ®µ
4. âœ… è¯„ä»·æ€»è§ˆ - å¾—åˆ†æƒ…å†µã€è¯„çº§
5. âœ… å„ç»´åº¦è¯¦ç»†åˆ†æ - 9å¤§ç»´åº¦å¾—åˆ†
6. âœ… ä¼˜åŠ¿ä¸ä¸è¶³ - å·²å®Œæˆ/æœªå®Œæˆé¡¹ç›®
7. âœ… æ”¹è¿›å»ºè®® - æ€»ä½“å»ºè®®ã€å…·ä½“æªæ–½
8. âœ… é™„å½• - é—®å·è¯¦ç»†æ•°æ®è¡¨æ ¼
```

### âš ï¸ éœ€è¦å¢å¼ºçš„åŠŸèƒ½

```
1. è¡Œä¸šå¯¹æ¯”åˆ†æ
   - ä¸åŒè¡Œä¸šä¼ä¸šå¯¹æ¯”
   - ä¸å›½å®¶æ ‡å‡†å¯¹æ¯”
   - è¡Œä¸šæ’åå’Œç™¾åˆ†ä½

2. æ™ºèƒ½æ”¹è¿›å»ºè®®
   - åŸºäºè¡Œä¸šæœ€ä½³å®è·µ
   - é’ˆå¯¹æ€§æ”¹è¿›è·¯å¾„
   - ä¼˜å…ˆçº§æ’åº
```

---

## ğŸ¯ å¢å¼ºæ–¹æ¡ˆè®¾è®¡

### æ–¹æ¡ˆ1: è¡Œä¸šå¯¹æ¯”åˆ†ææ¨¡å—

#### æ•°æ®æ¥æº
```python
# 1. ä»å…¶ä»–ä¼ä¸šæäº¤æ•°æ®ä¸­è·å–åŒè¡Œä¸šæ•°æ®
def get_industry_data(main_business, enterprise_scale):
    """
    ä»storage/nankai_submissions/è·å–åŒè¡Œä¸šä¼ä¸šæ•°æ®
    
    Args:
        main_business: ä¸»è¥ä¸šåŠ¡ï¼ˆè¡Œä¸šï¼‰
        enterprise_scale: ä¼ä¸šè§„æ¨¡
    
    Returns:
        åŒè¡Œä¸šä¼ä¸šå¾—åˆ†åˆ—è¡¨
    """
    industry_scores = []
    
    # éå†æ‰€æœ‰æäº¤
    for submission_file in os.listdir('storage/nankai_submissions'):
        if submission_file.endswith('.json'):
            with open(f'storage/nankai_submissions/{submission_file}') as f:
                data = json.load(f)
                
            # åŒ¹é…è¡Œä¸š
            if data['enterprise_info']['main_business'] == main_business:
                industry_scores.append({
                    'enterprise': data['enterprise_info']['enterprise_name'],
                    'score': data['score']['percentage'],
                    'scale': data['enterprise_info'].get('enterprise_scale', ''),
                    'level': data['level']
                })
    
    return industry_scores

# 2. å›½å®¶æ ‡å‡†æ•°æ®ï¼ˆå¯é…ç½®ï¼‰
NATIONAL_STANDARDS = {
    'åˆçº§': {
        'excellent': 90,  # ä¼˜ç§€çº¿
        'good': 80,       # è‰¯å¥½çº¿
        'pass': 60        # åŠæ ¼çº¿
    },
    'ä¸­çº§': {
        'excellent': 85,
        'good': 75,
        'pass': 60
    },
    'é«˜çº§': {
        'excellent': 80,
        'good': 70,
        'pass': 60
    }
}
```

#### å¯¹æ¯”åˆ†æå®ç°
```python
def _add_industry_comparison(self, doc, enterprise_info, score_info, level):
    """æ·»åŠ è¡Œä¸šå¯¹æ¯”åˆ†æ"""
    heading = doc.add_heading('å…­ã€è¡Œä¸šå¯¹æ¯”åˆ†æ', level=1)
    heading.runs[0].font.color.rgb = RGBColor(46, 80, 144)
    
    main_business = enterprise_info.get('main_business', '')
    enterprise_scale = enterprise_info.get('enterprise_scale', '')
    current_score = score_info.get('percentage', 0)
    
    # 1. è·å–è¡Œä¸šæ•°æ®
    industry_data = self._get_industry_data(main_business, enterprise_scale)
    
    if industry_data:
        # è®¡ç®—è¡Œä¸šç»Ÿè®¡
        industry_scores = [d['score'] for d in industry_data]
        avg_score = sum(industry_scores) / len(industry_scores)
        max_score = max(industry_scores)
        min_score = min(industry_scores)
        
        # è®¡ç®—æ’å
        rank = sum(1 for s in industry_scores if s > current_score) + 1
        percentile = (1 - rank / len(industry_scores)) * 100
        
        # è¾“å‡ºå¯¹æ¯”ç»“æœ
        doc.add_heading('ï¼ˆä¸€ï¼‰åŒè¡Œä¸šå¯¹æ¯”', level=2)
        
        p = doc.add_paragraph()
        p.add_run(f'è¡Œä¸šæ ·æœ¬æ•°ï¼š{len(industry_data)}å®¶ä¼ä¸š')
        
        p = doc.add_paragraph()
        p.add_run(f'è´µä¼ä¸šå¾—åˆ†ï¼š{current_score:.1f}åˆ†\n')
        p.add_run(f'è¡Œä¸šå¹³å‡åˆ†ï¼š{avg_score:.1f}åˆ†\n')
        p.add_run(f'è¡Œä¸šæœ€é«˜åˆ†ï¼š{max_score:.1f}åˆ†\n')
        p.add_run(f'è¡Œä¸šæœ€ä½åˆ†ï¼š{min_score:.1f}åˆ†')
        
        p = doc.add_paragraph()
        p.add_run(f'è¡Œä¸šæ’åï¼šç¬¬{rank}åï¼ˆå‰{percentile:.1f}%ï¼‰')
        
        # å¯¹æ¯”åˆ†æ
        if current_score > avg_score:
            analysis = f'è´µä¼ä¸šå¾—åˆ†é«˜äºè¡Œä¸šå¹³å‡æ°´å¹³{current_score - avg_score:.1f}åˆ†ï¼Œ'
            analysis += f'åœ¨{main_business}è¡Œä¸šä¸­å¤„äºé¢†å…ˆåœ°ä½ã€‚'
        elif current_score == avg_score:
            analysis = f'è´µä¼ä¸šå¾—åˆ†ä¸è¡Œä¸šå¹³å‡æ°´å¹³æŒå¹³ï¼Œå¤„äºè¡Œä¸šä¸­ç­‰æ°´å¹³ã€‚'
        else:
            analysis = f'è´µä¼ä¸šå¾—åˆ†ä½äºè¡Œä¸šå¹³å‡æ°´å¹³{avg_score - current_score:.1f}åˆ†ï¼Œ'
            analysis += f'å»ºè®®å‚è€ƒè¡Œä¸šä¼˜ç§€ä¼ä¸šçš„ç»éªŒï¼Œæå‡åˆ¶åº¦å»ºè®¾æ°´å¹³ã€‚'
        
        p = doc.add_paragraph()
        p.add_run('å¯¹æ¯”åˆ†æï¼š').bold = True
        p.add_run(analysis)
        
    else:
        p = doc.add_paragraph()
        p.add_run(f'æš‚æ— {main_business}è¡Œä¸šçš„å¯¹æ¯”æ•°æ®ã€‚')
    
    # 2. å›½å®¶æ ‡å‡†å¯¹æ¯”
    doc.add_heading('ï¼ˆäºŒï¼‰å›½å®¶æ ‡å‡†å¯¹æ¯”', level=2)
    
    standards = NATIONAL_STANDARDS.get(level, {})
    excellent_line = standards.get('excellent', 90)
    good_line = standards.get('good', 80)
    pass_line = standards.get('pass', 60)
    
    p = doc.add_paragraph()
    p.add_run(f'å›½å®¶ä¼˜ç§€æ ‡å‡†ï¼š{excellent_line}åˆ†\n')
    p.add_run(f'å›½å®¶è‰¯å¥½æ ‡å‡†ï¼š{good_line}åˆ†\n')
    p.add_run(f'å›½å®¶åŠæ ¼æ ‡å‡†ï¼š{pass_line}åˆ†')
    
    # è¾¾æ ‡åˆ†æ
    if current_score >= excellent_line:
        standard_analysis = f'è´µä¼ä¸šå¾—åˆ†è¾¾åˆ°å›½å®¶ä¼˜ç§€æ ‡å‡†ï¼Œåˆ¶åº¦å»ºè®¾æ°´å¹³ä¼˜å¼‚ã€‚'
    elif current_score >= good_line:
        standard_analysis = f'è´µä¼ä¸šå¾—åˆ†è¾¾åˆ°å›½å®¶è‰¯å¥½æ ‡å‡†ï¼Œåˆ¶åº¦å»ºè®¾æ°´å¹³è¾ƒå¥½ã€‚'
        standard_analysis += f'è·ç¦»ä¼˜ç§€æ ‡å‡†è¿˜å·®{excellent_line - current_score:.1f}åˆ†ã€‚'
    elif current_score >= pass_line:
        standard_analysis = f'è´µä¼ä¸šå¾—åˆ†è¾¾åˆ°å›½å®¶åŠæ ¼æ ‡å‡†ï¼Œåˆ¶åº¦å»ºè®¾åŸºæœ¬åˆæ ¼ã€‚'
        standard_analysis += f'è·ç¦»è‰¯å¥½æ ‡å‡†è¿˜å·®{good_line - current_score:.1f}åˆ†ã€‚'
    else:
        standard_analysis = f'è´µä¼ä¸šå¾—åˆ†æœªè¾¾åˆ°å›½å®¶åŠæ ¼æ ‡å‡†ï¼Œåˆ¶åº¦å»ºè®¾äºŸéœ€åŠ å¼ºã€‚'
        standard_analysis += f'è·ç¦»åŠæ ¼æ ‡å‡†è¿˜å·®{pass_line - current_score:.1f}åˆ†ã€‚'
    
    p = doc.add_paragraph()
    p.add_run('è¾¾æ ‡åˆ†æï¼š').bold = True
    p.add_run(standard_analysis)
    
    doc.add_paragraph()
```

---

### æ–¹æ¡ˆ2: æ™ºèƒ½æ”¹è¿›å»ºè®®æ¨¡å—

#### å»ºè®®ç”Ÿæˆé€»è¾‘
```python
def _generate_smart_recommendations(self, df, answers, score_info, industry_data):
    """
    ç”Ÿæˆæ™ºèƒ½æ”¹è¿›å»ºè®®
    
    åŸºäº:
    1. ä¼ä¸šè–„å¼±ç¯èŠ‚
    2. è¡Œä¸šæœ€ä½³å®è·µ
    3. æ”¹è¿›ä¼˜å…ˆçº§
    """
    recommendations = []
    score_details = score_info.get('details', {})
    
    # 1. è¯†åˆ«è–„å¼±ç¯èŠ‚
    weak_items = []
    for idx, row in df.iterrows():
        q_id = str(int(row['åºå·'])) if pd.notna(row['åºå·']) else str(idx + 1)
        answer = answers.get(q_id, '')
        detail = score_details.get(q_id, {})
        
        # æœªå®Œæˆæˆ–éƒ¨åˆ†å®Œæˆçš„é¡¹ç›®
        if answer.startswith('B') or answer.startswith('C'):
            weak_items.append({
                'id': q_id,
                'level1': str(row['ä¸€çº§æŒ‡æ ‡']),
                'level2': str(row['äºŒçº§æŒ‡æ ‡']),
                'level3': str(row['ä¸‰çº§æŒ‡æ ‡']),
                'score_loss': detail.get('max_score', 0) - detail.get('earned_score', 0),
                'answer': answer
            })
    
    # 2. æŒ‰å¤±åˆ†æ’åºï¼ˆä¼˜å…ˆçº§ï¼‰
    weak_items.sort(key=lambda x: x['score_loss'], reverse=True)
    
    # 3. ç”Ÿæˆé’ˆå¯¹æ€§å»ºè®®
    for item in weak_items[:10]:  # å‰10ä¸ªæœ€é‡è¦çš„
        recommendation = {
            'dimension': item['level1'],
            'issue': item['level3'],
            'priority': 'high' if item['score_loss'] > 2 else 'medium',
            'suggestion': self._get_improvement_suggestion(item),
            'best_practice': self._get_industry_best_practice(item, industry_data)
        }
        recommendations.append(recommendation)
    
    return recommendations

def _get_improvement_suggestion(self, item):
    """æ ¹æ®é—®é¢˜ç±»å‹ç”Ÿæˆæ”¹è¿›å»ºè®®"""
    level1 = item['level1']
    level3 = item['level3']
    
    # å»ºè®®æ¨¡æ¿åº“
    suggestion_templates = {
        'å…šå»ºå¼•é¢†': 'å»ºè®®åŠ å¼ºå…šç»„ç»‡å»ºè®¾ï¼Œå®Œå–„å…šå»ºå·¥ä½œåˆ¶åº¦ï¼Œç¡®ä¿å…šçš„é¢†å¯¼èå…¥ä¼ä¸šæ²»ç†å„ç¯èŠ‚ã€‚',
        'äº§æƒç»“æ„': 'å»ºè®®æ˜æ™°äº§æƒå…³ç³»ï¼Œå®Œå–„è‚¡æƒç»“æ„ï¼Œå»ºç«‹è§„èŒƒçš„äº§æƒç®¡ç†åˆ¶åº¦ã€‚',
        'å…¬å¸æ²»ç†ç»“æ„å’Œæœºåˆ¶': 'å»ºè®®å®Œå–„å…¬å¸æ²»ç†æ¶æ„ï¼Œå»ºç«‹å¥å…¨è‚¡ä¸œä¼šã€è‘£äº‹ä¼šã€ç›‘äº‹ä¼šåˆ¶åº¦ã€‚',
        'æˆ˜ç•¥ç®¡ç†': 'å»ºè®®åˆ¶å®šæ˜ç¡®çš„ä¼ä¸šæˆ˜ç•¥è§„åˆ’ï¼Œå»ºç«‹æˆ˜ç•¥æ‰§è¡Œå’Œç›‘æ§æœºåˆ¶ã€‚',
        'å†…æ§ã€é£é™©ä¸åˆè§„ç®¡ç†': 'å»ºè®®å»ºç«‹å®Œå–„çš„å†…éƒ¨æ§åˆ¶ä½“ç³»ï¼ŒåŠ å¼ºé£é™©è¯†åˆ«å’Œé˜²æ§ã€‚',
        'ç§‘å­¦æ°‘ä¸»ç®¡ç†': 'å»ºè®®å®Œå–„æ°‘ä¸»ç®¡ç†åˆ¶åº¦ï¼Œä¿éšœå‘˜å·¥å‚ä¸æƒå’ŒçŸ¥æƒ…æƒã€‚',
        'ç§‘æŠ€åˆ›æ–°': 'å»ºè®®åŠ å¤§ç ”å‘æŠ•å…¥ï¼Œå»ºç«‹åˆ›æ–°æ¿€åŠ±æœºåˆ¶ï¼Œæå‡æŠ€æœ¯åˆ›æ–°èƒ½åŠ›ã€‚',
        'ç¤¾ä¼šè´£ä»»ä¸ä¼ä¸šæ–‡åŒ–': 'å»ºè®®ç§¯æå±¥è¡Œç¤¾ä¼šè´£ä»»ï¼ŒåŸ¹è‚²ä¼˜ç§€ä¼ä¸šæ–‡åŒ–ã€‚',
        'å®¶æ—ä¼ä¸šæ²»ç†': 'å»ºè®®å»ºç«‹å®¶æ—ä¼ä¸šæ²»ç†æœºåˆ¶ï¼Œå®ç°å®¶æ—æ²»ç†ä¸ä¼ä¸šæ²»ç†çš„æœ‰æ•ˆåˆ†ç¦»ã€‚'
    }
    
    base_suggestion = suggestion_templates.get(level1, 'å»ºè®®å®Œå–„ç›¸å…³åˆ¶åº¦å»ºè®¾ã€‚')
    
    # é’ˆå¯¹å…·ä½“é—®é¢˜çš„å»ºè®®
    specific_suggestion = f'é’ˆå¯¹"{level3}"ï¼Œ{base_suggestion}'
    
    return specific_suggestion

def _get_industry_best_practice(self, item, industry_data):
    """è·å–è¡Œä¸šæœ€ä½³å®è·µ"""
    if not industry_data:
        return 'å»ºè®®å‚è€ƒè¡Œä¸šæ ‡æ†ä¼ä¸šçš„æˆåŠŸç»éªŒã€‚'
    
    # æ‰¾å‡ºåœ¨è¯¥ç»´åº¦è¡¨ç°ä¼˜ç§€çš„ä¼ä¸š
    level1 = item['level1']
    
    best_practice = f'è¡Œä¸šä¼˜ç§€ä¼ä¸šåœ¨{level1}æ–¹é¢çš„åšæ³•ï¼š\n'
    best_practice += '1. å»ºç«‹å®Œå–„çš„åˆ¶åº¦ä½“ç³»\n'
    best_practice += '2. æ³¨é‡åˆ¶åº¦æ‰§è¡Œå’Œç›‘ç£\n'
    best_practice += '3. å®šæœŸè¯„ä¼°å’ŒæŒç»­æ”¹è¿›'
    
    return best_practice
```

#### å¢å¼ºç‰ˆæ”¹è¿›å»ºè®®è¾“å‡º
```python
def _add_smart_recommendations(self, doc, df, answers, score_info, industry_data):
    """æ·»åŠ æ™ºèƒ½æ”¹è¿›å»ºè®®"""
    heading = doc.add_heading('ä¸ƒã€æ™ºèƒ½æ”¹è¿›å»ºè®®', level=1)
    heading.runs[0].font.color.rgb = RGBColor(46, 80, 144)
    
    # ç”Ÿæˆå»ºè®®
    recommendations = self._generate_smart_recommendations(
        df, answers, score_info, industry_data
    )
    
    if not recommendations:
        doc.add_paragraph('å„é¡¹æŒ‡æ ‡å‡å·²è¾¾æ ‡ï¼Œå»ºè®®ç»§ç»­ä¿æŒã€‚')
        return
    
    # 1. æ”¹è¿›ä¼˜å…ˆçº§è¯´æ˜
    doc.add_heading('ï¼ˆä¸€ï¼‰æ”¹è¿›ä¼˜å…ˆçº§', level=2)
    
    p = doc.add_paragraph()
    p.add_run('æ ¹æ®å¤±åˆ†æƒ…å†µå’Œè¡Œä¸šå¯¹æ¯”ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§è¿›è¡Œæ”¹è¿›ï¼š')
    
    high_priority = [r for r in recommendations if r['priority'] == 'high']
    medium_priority = [r for r in recommendations if r['priority'] == 'medium']
    
    if high_priority:
        p = doc.add_paragraph()
        p.add_run('é«˜ä¼˜å…ˆçº§ï¼ˆå»ºè®®3ä¸ªæœˆå†…å®Œæˆï¼‰ï¼š').bold = True
        for rec in high_priority:
            doc.add_paragraph(rec['issue'], style='List Bullet')
    
    if medium_priority:
        p = doc.add_paragraph()
        p.add_run('ä¸­ä¼˜å…ˆçº§ï¼ˆå»ºè®®6ä¸ªæœˆå†…å®Œæˆï¼‰ï¼š').bold = True
        for rec in medium_priority:
            doc.add_paragraph(rec['issue'], style='List Bullet')
    
    # 2. è¯¦ç»†æ”¹è¿›æ–¹æ¡ˆ
    doc.add_heading('ï¼ˆäºŒï¼‰è¯¦ç»†æ”¹è¿›æ–¹æ¡ˆ', level=2)
    
    for i, rec in enumerate(recommendations[:5], 1):  # è¯¦ç»†å±•ç¤ºå‰5é¡¹
        doc.add_heading(f'{i}. {rec["dimension"]} - {rec["issue"]}', level=3)
        
        # é—®é¢˜æè¿°
        p = doc.add_paragraph()
        p.add_run('é—®é¢˜æè¿°ï¼š').bold = True
        p.add_run(f'è¯¥é¡¹ç›®å½“å‰æœªè¾¾æ ‡ï¼Œéœ€è¦é‡ç‚¹æ”¹è¿›ã€‚')
        
        # æ”¹è¿›å»ºè®®
        p = doc.add_paragraph()
        p.add_run('æ”¹è¿›å»ºè®®ï¼š').bold = True
        p.add_run(rec['suggestion'])
        
        # è¡Œä¸šæœ€ä½³å®è·µ
        p = doc.add_paragraph()
        p.add_run('è¡Œä¸šæœ€ä½³å®è·µï¼š').bold = True
        p.add_run(rec['best_practice'])
        
        doc.add_paragraph()
    
    # 3. æ”¹è¿›è·¯å¾„å›¾
    doc.add_heading('ï¼ˆä¸‰ï¼‰æ”¹è¿›è·¯å¾„å›¾', level=2)
    
    p = doc.add_paragraph()
    p.add_run('å»ºè®®åˆ†é˜¶æ®µæ¨è¿›æ”¹è¿›å·¥ä½œï¼š')
    
    doc.add_paragraph('ç¬¬ä¸€é˜¶æ®µï¼ˆ1-3ä¸ªæœˆï¼‰ï¼šå®Œæˆé«˜ä¼˜å…ˆçº§é¡¹ç›®ï¼Œå»ºç«‹åŸºç¡€åˆ¶åº¦æ¡†æ¶', style='List Number')
    doc.add_paragraph('ç¬¬äºŒé˜¶æ®µï¼ˆ4-6ä¸ªæœˆï¼‰ï¼šå®Œæˆä¸­ä¼˜å…ˆçº§é¡¹ç›®ï¼Œå®Œå–„åˆ¶åº¦ä½“ç³»', style='List Number')
    doc.add_paragraph('ç¬¬ä¸‰é˜¶æ®µï¼ˆ7-12ä¸ªæœˆï¼‰ï¼šæŒç»­ä¼˜åŒ–æ”¹è¿›ï¼Œæå‡åˆ¶åº¦æ‰§è¡Œæ•ˆæœ', style='List Number')
    
    doc.add_paragraph()
```

---

## ğŸ”§ å®æ–½æ­¥éª¤

### æ­¥éª¤1: ä¿®æ”¹nankai_report_generator.py

```python
# åœ¨generate_reportæ–¹æ³•ä¸­æ·»åŠ è¡Œä¸šæ•°æ®è·å–
def generate_report(self, submission_file):
    # ... ç°æœ‰ä»£ç  ...
    
    # è·å–è¡Œä¸šæ•°æ®
    industry_data = self._get_industry_data(
        enterprise_info.get('main_business', ''),
        enterprise_info.get('enterprise_scale', '')
    )
    
    # ... ç°æœ‰ç« èŠ‚ ...
    
    # 6. è¡Œä¸šå¯¹æ¯”åˆ†æï¼ˆæ–°å¢ï¼‰
    self._add_industry_comparison(doc, enterprise_info, score_info, level)
    
    # 7. æ™ºèƒ½æ”¹è¿›å»ºè®®ï¼ˆå¢å¼ºï¼‰
    self._add_smart_recommendations(doc, df, answers, score_info, industry_data)
    
    # 8. é™„å½•
    self._add_appendix(doc, df, answers, partial_details, score_info)
    
    # ... ä¿å­˜æŠ¥å‘Š ...
```

### æ­¥éª¤2: æ·»åŠ è¾…åŠ©æ–¹æ³•

```python
def _get_industry_data(self, main_business, enterprise_scale):
    """è·å–åŒè¡Œä¸šä¼ä¸šæ•°æ®"""
    # å®ç°ä»£ç è§ä¸Šæ–‡
    pass

def _generate_smart_recommendations(self, df, answers, score_info, industry_data):
    """ç”Ÿæˆæ™ºèƒ½æ”¹è¿›å»ºè®®"""
    # å®ç°ä»£ç è§ä¸Šæ–‡
    pass

def _get_improvement_suggestion(self, item):
    """ç”Ÿæˆæ”¹è¿›å»ºè®®"""
    # å®ç°ä»£ç è§ä¸Šæ–‡
    pass

def _get_industry_best_practice(self, item, industry_data):
    """è·å–è¡Œä¸šæœ€ä½³å®è·µ"""
    # å®ç°ä»£ç è§ä¸Šæ–‡
    pass
```

### æ­¥éª¤3: é…ç½®å›½å®¶æ ‡å‡†æ•°æ®

```python
# åœ¨ç±»åˆå§‹åŒ–æ—¶åŠ è½½
def __init__(self, indicator_file='æŒ‡æ ‡ä½“ç³».xlsx'):
    self.indicator_file = indicator_file
    self.national_standards = {
        'åˆçº§': {'excellent': 90, 'good': 80, 'pass': 60},
        'ä¸­çº§': {'excellent': 85, 'good': 75, 'pass': 60},
        'é«˜çº§': {'excellent': 80, 'good': 70, 'pass': 60}
    }
```

---

## ğŸ“Š å¢å¼ºåçš„æŠ¥å‘Šç»“æ„

```
å—å¼€å¤§å­¦ç°ä»£ä¼ä¸šåˆ¶åº¦æŒ‡æ•°è¯„ä»·è‡ªè¯„æŠ¥å‘Š
â”œâ”€â”€ å°é¢
â”œâ”€â”€ æ‰§è¡Œæ‘˜è¦
â”œâ”€â”€ ä¸€ã€ä¼ä¸šåŸºæœ¬ä¿¡æ¯
â”œâ”€â”€ äºŒã€è¯„ä»·æ€»è§ˆ
â”œâ”€â”€ ä¸‰ã€å„ç»´åº¦è¯¦ç»†åˆ†æ
â”œâ”€â”€ å››ã€ä¼˜åŠ¿ä¸ä¸è¶³
â”œâ”€â”€ äº”ã€æ”¹è¿›å»ºè®®
â”œâ”€â”€ å…­ã€è¡Œä¸šå¯¹æ¯”åˆ†æ â­ æ–°å¢
â”‚   â”œâ”€â”€ ï¼ˆä¸€ï¼‰åŒè¡Œä¸šå¯¹æ¯”
â”‚   â”‚   â”œâ”€â”€ è¡Œä¸šæ ·æœ¬æ•°
â”‚   â”‚   â”œâ”€â”€ å¾—åˆ†å¯¹æ¯”ï¼ˆä¼ä¸š/å¹³å‡/æœ€é«˜/æœ€ä½ï¼‰
â”‚   â”‚   â”œâ”€â”€ è¡Œä¸šæ’åå’Œç™¾åˆ†ä½
â”‚   â”‚   â””â”€â”€ å¯¹æ¯”åˆ†æ
â”‚   â””â”€â”€ ï¼ˆäºŒï¼‰å›½å®¶æ ‡å‡†å¯¹æ¯”
â”‚       â”œâ”€â”€ æ ‡å‡†çº¿ï¼ˆä¼˜ç§€/è‰¯å¥½/åŠæ ¼ï¼‰
â”‚       â””â”€â”€ è¾¾æ ‡åˆ†æ
â”œâ”€â”€ ä¸ƒã€æ™ºèƒ½æ”¹è¿›å»ºè®® â­ å¢å¼º
â”‚   â”œâ”€â”€ ï¼ˆä¸€ï¼‰æ”¹è¿›ä¼˜å…ˆçº§
â”‚   â”‚   â”œâ”€â”€ é«˜ä¼˜å…ˆçº§é¡¹ç›®
â”‚   â”‚   â””â”€â”€ ä¸­ä¼˜å…ˆçº§é¡¹ç›®
â”‚   â”œâ”€â”€ ï¼ˆäºŒï¼‰è¯¦ç»†æ”¹è¿›æ–¹æ¡ˆ
â”‚   â”‚   â”œâ”€â”€ é—®é¢˜æè¿°
â”‚   â”‚   â”œâ”€â”€ æ”¹è¿›å»ºè®®
â”‚   â”‚   â””â”€â”€ è¡Œä¸šæœ€ä½³å®è·µ
â”‚   â””â”€â”€ ï¼ˆä¸‰ï¼‰æ”¹è¿›è·¯å¾„å›¾
â”‚       â”œâ”€â”€ ç¬¬ä¸€é˜¶æ®µï¼ˆ1-3ä¸ªæœˆï¼‰
â”‚       â”œâ”€â”€ ç¬¬äºŒé˜¶æ®µï¼ˆ4-6ä¸ªæœˆï¼‰
â”‚       â””â”€â”€ ç¬¬ä¸‰é˜¶æ®µï¼ˆ7-12ä¸ªæœˆï¼‰
â””â”€â”€ é™„å½•ï¼šé—®å·è¯¦ç»†æ•°æ®
```

---

## ğŸ¯ æ•ˆæœç¤ºä¾‹

### è¡Œä¸šå¯¹æ¯”ç¤ºä¾‹
```
å…­ã€è¡Œä¸šå¯¹æ¯”åˆ†æ

ï¼ˆä¸€ï¼‰åŒè¡Œä¸šå¯¹æ¯”

è¡Œä¸šæ ·æœ¬æ•°ï¼š15å®¶ä¼ä¸š

è´µä¼ä¸šå¾—åˆ†ï¼š72.5åˆ†
è¡Œä¸šå¹³å‡åˆ†ï¼š68.3åˆ†
è¡Œä¸šæœ€é«˜åˆ†ï¼š85.2åˆ†
è¡Œä¸šæœ€ä½åˆ†ï¼š52.1åˆ†

è¡Œä¸šæ’åï¼šç¬¬5åï¼ˆå‰33.3%ï¼‰

å¯¹æ¯”åˆ†æï¼šè´µä¼ä¸šå¾—åˆ†é«˜äºè¡Œä¸šå¹³å‡æ°´å¹³4.2åˆ†ï¼Œåœ¨åˆ¶é€ ä¸šè¡Œä¸šä¸­
å¤„äºé¢†å…ˆåœ°ä½ã€‚

ï¼ˆäºŒï¼‰å›½å®¶æ ‡å‡†å¯¹æ¯”

å›½å®¶ä¼˜ç§€æ ‡å‡†ï¼š90åˆ†
å›½å®¶è‰¯å¥½æ ‡å‡†ï¼š80åˆ†
å›½å®¶åŠæ ¼æ ‡å‡†ï¼š60åˆ†

è¾¾æ ‡åˆ†æï¼šè´µä¼ä¸šå¾—åˆ†è¾¾åˆ°å›½å®¶åŠæ ¼æ ‡å‡†ï¼Œåˆ¶åº¦å»ºè®¾åŸºæœ¬åˆæ ¼ã€‚
è·ç¦»è‰¯å¥½æ ‡å‡†è¿˜å·®7.5åˆ†ã€‚
```

### æ™ºèƒ½å»ºè®®ç¤ºä¾‹
```
ä¸ƒã€æ™ºèƒ½æ”¹è¿›å»ºè®®

ï¼ˆä¸€ï¼‰æ”¹è¿›ä¼˜å…ˆçº§

é«˜ä¼˜å…ˆçº§ï¼ˆå»ºè®®3ä¸ªæœˆå†…å®Œæˆï¼‰ï¼š
â€¢ å»ºç«‹å®Œå–„çš„å†…éƒ¨æ§åˆ¶åˆ¶åº¦
â€¢ å®Œå–„é£é™©ç®¡ç†ä½“ç³»
â€¢ å»ºç«‹ç§‘æŠ€åˆ›æ–°æ¿€åŠ±æœºåˆ¶

ï¼ˆäºŒï¼‰è¯¦ç»†æ”¹è¿›æ–¹æ¡ˆ

1. å†…æ§ã€é£é™©ä¸åˆè§„ç®¡ç† - å»ºç«‹å®Œå–„çš„å†…éƒ¨æ§åˆ¶åˆ¶åº¦

é—®é¢˜æè¿°ï¼šè¯¥é¡¹ç›®å½“å‰æœªè¾¾æ ‡ï¼Œéœ€è¦é‡ç‚¹æ”¹è¿›ã€‚

æ”¹è¿›å»ºè®®ï¼šé’ˆå¯¹"å»ºç«‹å®Œå–„çš„å†…éƒ¨æ§åˆ¶åˆ¶åº¦"ï¼Œå»ºè®®å»ºç«‹å®Œå–„çš„
å†…éƒ¨æ§åˆ¶ä½“ç³»ï¼ŒåŠ å¼ºé£é™©è¯†åˆ«å’Œé˜²æ§ã€‚

è¡Œä¸šæœ€ä½³å®è·µï¼šè¡Œä¸šä¼˜ç§€ä¼ä¸šåœ¨å†…æ§ã€é£é™©ä¸åˆè§„ç®¡ç†æ–¹é¢çš„åšæ³•ï¼š
1. å»ºç«‹å®Œå–„çš„åˆ¶åº¦ä½“ç³»
2. æ³¨é‡åˆ¶åº¦æ‰§è¡Œå’Œç›‘ç£
3. å®šæœŸè¯„ä¼°å’ŒæŒç»­æ”¹è¿›

ï¼ˆä¸‰ï¼‰æ”¹è¿›è·¯å¾„å›¾

å»ºè®®åˆ†é˜¶æ®µæ¨è¿›æ”¹è¿›å·¥ä½œï¼š
1. ç¬¬ä¸€é˜¶æ®µï¼ˆ1-3ä¸ªæœˆï¼‰ï¼šå®Œæˆé«˜ä¼˜å…ˆçº§é¡¹ç›®ï¼Œå»ºç«‹åŸºç¡€åˆ¶åº¦æ¡†æ¶
2. ç¬¬äºŒé˜¶æ®µï¼ˆ4-6ä¸ªæœˆï¼‰ï¼šå®Œæˆä¸­ä¼˜å…ˆçº§é¡¹ç›®ï¼Œå®Œå–„åˆ¶åº¦ä½“ç³»
3. ç¬¬ä¸‰é˜¶æ®µï¼ˆ7-12ä¸ªæœˆï¼‰ï¼šæŒç»­ä¼˜åŒ–æ”¹è¿›ï¼Œæå‡åˆ¶åº¦æ‰§è¡Œæ•ˆæœ
```

---

## âœ… æ€»ç»“

### å½“å‰çŠ¶æ€
- âœ… æŠ¥å‘Šç”Ÿæˆå™¨å·²å®ç°åŸºç¡€åŠŸèƒ½
- âœ… åŒ…å«8ä¸ªæ ‡å‡†ç« èŠ‚
- âœ… è‡ªåŠ¨ç”Ÿæˆå’Œé‚®ä»¶å‘é€

### éœ€è¦æ·»åŠ 
1. **è¡Œä¸šå¯¹æ¯”åˆ†æ**
   - ä»å…¶ä»–ä¼ä¸šæ•°æ®ä¸­æå–åŒè¡Œä¸šä¿¡æ¯
   - è®¡ç®—è¡Œä¸šç»Ÿè®¡æ•°æ®å’Œæ’å
   - ä¸å›½å®¶æ ‡å‡†å¯¹æ¯”

2. **æ™ºèƒ½æ”¹è¿›å»ºè®®**
   - è¯†åˆ«è–„å¼±ç¯èŠ‚
   - æŒ‰ä¼˜å…ˆçº§æ’åº
   - æä¾›é’ˆå¯¹æ€§å»ºè®®å’Œæœ€ä½³å®è·µ
   - åˆ¶å®šæ”¹è¿›è·¯å¾„å›¾

### å®æ–½éš¾åº¦
- ğŸŸ¢ **ä½éš¾åº¦** - ä»£ç ç»“æ„æ¸…æ™°ï¼Œåªéœ€æ·»åŠ æ–°æ–¹æ³•
- ğŸŸ¢ **æ•°æ®å¯ç”¨** - æ‰€æœ‰æ•°æ®éƒ½å·²å­˜å‚¨åœ¨ç³»ç»Ÿä¸­
- ğŸŸ¢ **æ˜“äºæ‰©å±•** - å»ºè®®æ¨¡æ¿å¯é…ç½®åŒ–

å»ºè®®ä¼˜å…ˆå®æ–½è¡Œä¸šå¯¹æ¯”åŠŸèƒ½ï¼Œç„¶åé€æ­¥å®Œå–„æ™ºèƒ½å»ºè®®ç®—æ³•ï¼