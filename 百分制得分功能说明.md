# ç™¾åˆ†åˆ¶å¾—åˆ†åŠŸèƒ½è¯´æ˜

## âœ… åŠŸèƒ½æ¦‚è¿°

å—å¼€é—®å·ç³»ç»Ÿç°å·²å®Œæ•´å®ç°**ç™¾åˆ†åˆ¶å¾—åˆ†**åŠŸèƒ½ï¼Œç”¨æˆ·æäº¤é—®å·åå¯ä»¥çœ‹åˆ°ï¼š
1. **ç™¾åˆ†åˆ¶ç»¼åˆå¾—åˆ†**ï¼ˆ0-100åˆ†ï¼‰
2. **å®é™…å¾—åˆ†**ï¼ˆåŸºäºExcelé¢˜ç›®åˆ†å€¼ï¼‰
3. **æ»¡åˆ†**ï¼ˆæ‰€æœ‰é¢˜ç›®åˆ†å€¼æ€»å’Œï¼‰
4. **è¯„çº§**ï¼ˆä¼˜ç§€/è‰¯å¥½/ä¸­ç­‰/åŠæ ¼/éœ€æ”¹è¿›ï¼‰

---

## ğŸ“Š è¯„åˆ†è§„åˆ™

### 1. é¢˜ç›®åˆ†å€¼æ¥æº
- ä»Excelæ–‡ä»¶çš„**"åˆ†å€¼"åˆ—**è¯»å–æ¯é¢˜çš„å®é™…åˆ†å€¼
- æ”¯æŒèŒƒå›´åˆ†å€¼ï¼ˆå¦‚"0-2"ï¼‰ï¼Œè‡ªåŠ¨å–æœ€å¤§å€¼
- å¦‚æœæ²¡æœ‰åˆ†å€¼åˆ—ï¼Œé»˜è®¤æ¯é¢˜1åˆ†

### 2. ç­”æ¡ˆè¯„åˆ†æ ‡å‡†
| é€‰é¡¹ | å¾—åˆ†æ¯”ä¾‹ | è¯´æ˜ |
|------|---------|------|
| **A. å·²å®Œæˆ** | 100% | è·å¾—è¯¥é¢˜å…¨éƒ¨åˆ†å€¼ |
| **B. éƒ¨åˆ†å®Œæˆ** | 80% | è·å¾—è¯¥é¢˜80%åˆ†å€¼ |
| **C. æœªå®Œæˆ** | 0% | ä¸å¾—åˆ† |

### 3. ç™¾åˆ†åˆ¶è®¡ç®—å…¬å¼
```
ç™¾åˆ†åˆ¶å¾—åˆ† = (å®é™…å¾—åˆ† / æ»¡åˆ†) Ã— 100
```

### 4. è¯„çº§æ ‡å‡†
| åˆ†æ•°åŒºé—´ | è¯„çº§ | è¯´æ˜ |
|---------|------|------|
| 90-100åˆ† | ä¼˜ç§€ | ä¼ä¸šåˆ¶åº¦å»ºè®¾è¾¾åˆ°å“è¶Šæ°´å¹³ |
| 80-89åˆ† | è‰¯å¥½ | ä¼ä¸šåˆ¶åº¦å»ºè®¾è¾ƒä¸ºå®Œå–„ |
| 70-79åˆ† | ä¸­ç­‰ | ä¼ä¸šåˆ¶åº¦å»ºè®¾åŸºæœ¬å¥å…¨ |
| 60-69åˆ† | åŠæ ¼ | ä¼ä¸šåˆ¶åº¦å»ºè®¾æœ‰å¾…æå‡ |
| 0-59åˆ† | éœ€æ”¹è¿› | ä¼ä¸šåˆ¶åº¦å»ºè®¾äºŸéœ€åŠ å¼º |

---

## ğŸ’» æŠ€æœ¯å®ç°

### åç«¯å®ç°ï¼ˆapp.pyï¼‰

#### 1. åˆ†å€¼è¯»å–ï¼ˆç¬¬828-903è¡Œï¼‰
```python
# ä»Excelè¯»å–é¢˜ç›®åˆ†å€¼
df = pd.read_excel(excel_path, sheet_name=level)
for idx, row in df.iterrows():
    score = 0
    if 'åˆ†å€¼' in df.columns and pd.notna(row['åˆ†å€¼']):
        score_str = str(row['åˆ†å€¼'])
        # å¤„ç†èŒƒå›´åˆ†å€¼ï¼Œå¦‚"0-2"ï¼Œå–æœ€å¤§å€¼
        if '-' in score_str:
            score = float(score_str.split('-')[1])
        else:
            score = float(score_str)
```

#### 2. å¾—åˆ†è®¡ç®—ï¼ˆç¬¬1043-1069è¡Œï¼‰
```python
# è®¡ç®—æ¯é¢˜å¾—åˆ†
for question_id, answer in answers.items():
    q_score = question_scores.get(question_id, 1)
    option_letter = answer[0]  # æå–é€‰é¡¹å­—æ¯
    
    # æ ¹æ®é€‰é¡¹è®¡ç®—å¾—åˆ†
    if option_letter == 'A':
        earned_score = q_score  # 100%
    elif option_letter == 'B':
        earned_score = q_score * 0.8  # 80%
    else:
        earned_score = 0  # 0%
    
    total_score += earned_score

# è®¡ç®—ç™¾åˆ†åˆ¶å¾—åˆ†
final_score = (total_score / max_score * 100) if max_score > 0 else 0
```

#### 3. è¿”å›æ•°æ®ï¼ˆç¬¬1100-1108è¡Œï¼‰
```python
return jsonify({
    'success': True,
    'score': round(final_score, 2),  # ç™¾åˆ†åˆ¶å¾—åˆ†
    'total_score': round(total_score, 2),  # å®é™…å¾—åˆ†
    'max_score': round(max_score, 2),  # æ»¡åˆ†
    'message': 'é—®å·æäº¤æˆåŠŸ'
})
```

#### 4. ç»“æœé¡µé¢è·¯ç”±ï¼ˆç¬¬1117-1130è¡Œï¼‰
```python
@app.route('/nankai-result')
def nankai_result_page():
    score = request.args.get('score', '0')
    total_score = request.args.get('total_score', '0')
    max_score = request.args.get('max_score', '100')
    level = request.args.get('level', 'åˆçº§')
    enterprise = request.args.get('enterprise', 'ä¼ä¸š')
    return render_template('nankai_result.html', 
                         score=score, 
                         total_score=total_score,
                         max_score=max_score,
                         level=level, 
                         enterprise=enterprise)
```

### å‰ç«¯å®ç°

#### 1. æäº¤è·³è½¬ï¼ˆnankai_questionnaire_fill.html ç¬¬672-679è¡Œï¼‰
```javascript
if (result.success) {
    const params = new URLSearchParams({
        score: result.score,  // ç™¾åˆ†åˆ¶å¾—åˆ†
        total_score: result.total_score,  // å®é™…å¾—åˆ†
        max_score: result.max_score,  // æ»¡åˆ†
        level: '{{ level_name }}',
        enterprise: formData.get('enterprise_name')
    });
    window.location.href = `/nankai-result?${params.toString()}`;
}
```

#### 2. ç»“æœæ˜¾ç¤ºï¼ˆnankai_result.html ç¬¬45-52è¡Œï¼‰
```html
<div class="score-section">
    <div class="score-label">æ‚¨çš„ä¼ä¸šç»¼åˆå¾—åˆ†</div>
    <div class="score-value" id="scoreValue">{{ score }}åˆ†</div>
    <div class="score-level" id="scoreLevel">åŠ è½½ä¸­...</div>
    <div style="margin-top: 20px; font-size: 16px; color: #666;">
        <div>å®é™…å¾—åˆ†ï¼š<strong>{{ total_score }}</strong> åˆ†</div>
        <div>æ»¡åˆ†ï¼š<strong>{{ max_score }}</strong> åˆ†</div>
    </div>
</div>
```

#### 3. è¯„çº§æ˜¾ç¤ºï¼ˆnankai_result.html ç¬¬91-122è¡Œï¼‰
```javascript
const score = parseFloat(urlParams.get('score') || '{{ score }}' || '0');

if (score >= 90) {
    scoreLevel.textContent = 'ä¼˜ç§€ - ä¼ä¸šåˆ¶åº¦å»ºè®¾è¾¾åˆ°å“è¶Šæ°´å¹³';
    scoreLevel.style.color = '#28a745';
} else if (score >= 80) {
    scoreLevel.textContent = 'è‰¯å¥½ - ä¼ä¸šåˆ¶åº¦å»ºè®¾è¾ƒä¸ºå®Œå–„';
    scoreLevel.style.color = '#17a2b8';
} else if (score >= 70) {
    scoreLevel.textContent = 'ä¸­ç­‰ - ä¼ä¸šåˆ¶åº¦å»ºè®¾åŸºæœ¬å¥å…¨';
    scoreLevel.style.color = '#ffc107';
} else if (score >= 60) {
    scoreLevel.textContent = 'åŠæ ¼ - ä¼ä¸šåˆ¶åº¦å»ºè®¾æœ‰å¾…æå‡';
    scoreLevel.style.color = '#fd7e14';
} else {
    scoreLevel.textContent = 'éœ€æ”¹è¿› - ä¼ä¸šåˆ¶åº¦å»ºè®¾äºŸéœ€åŠ å¼º';
    scoreLevel.style.color = '#dc3545';
}
```

---

## ğŸ“ è¯„åˆ†ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåˆçº§é—®å·ï¼ˆ64é¢˜ï¼Œæ€»åˆ†64åˆ†ï¼‰

| é¢˜å· | åˆ†å€¼ | é€‰æ‹© | å¾—åˆ† | è®¡ç®— |
|------|------|------|------|------|
| 1 | 1åˆ† | A. å·²å®Œæˆ | 1.0åˆ† | 1 Ã— 100% |
| 2 | 2åˆ† | B. éƒ¨åˆ†å®Œæˆ | 1.6åˆ† | 2 Ã— 80% |
| 3 | 1åˆ† | C. æœªå®Œæˆ | 0åˆ† | 1 Ã— 0% |
| ... | ... | ... | ... | ... |
| **æ€»è®¡** | **64åˆ†** | - | **45.6åˆ†** | - |

**æœ€ç»ˆå¾—åˆ†**ï¼š
- å®é™…å¾—åˆ†ï¼š45.6åˆ†
- æ»¡åˆ†ï¼š64åˆ†
- **ç™¾åˆ†åˆ¶å¾—åˆ†ï¼š71.25åˆ†**
- è¯„çº§ï¼š**ä¸­ç­‰**

### ç¤ºä¾‹2ï¼šé«˜çº§é—®å·ï¼ˆ100é¢˜ï¼Œæ€»åˆ†150åˆ†ï¼‰

| é¢˜å· | åˆ†å€¼ | é€‰æ‹© | å¾—åˆ† | è®¡ç®— |
|------|------|------|------|------|
| 1 | 2åˆ† | A. å·²å®Œæˆ | 2.0åˆ† | 2 Ã— 100% |
| 2 | 1.5åˆ† | B. éƒ¨åˆ†å®Œæˆ | 1.2åˆ† | 1.5 Ã— 80% |
| 3 | 2åˆ† | A. å·²å®Œæˆ | 2.0åˆ† | 2 Ã— 100% |
| ... | ... | ... | ... | ... |
| **æ€»è®¡** | **150åˆ†** | - | **135åˆ†** | - |

**æœ€ç»ˆå¾—åˆ†**ï¼š
- å®é™…å¾—åˆ†ï¼š135åˆ†
- æ»¡åˆ†ï¼š150åˆ†
- **ç™¾åˆ†åˆ¶å¾—åˆ†ï¼š90åˆ†**
- è¯„çº§ï¼š**ä¼˜ç§€**

---

## ğŸ¯ æ•°æ®å­˜å‚¨æ ¼å¼

æäº¤çš„é—®å·æ•°æ®ä¿å­˜åœ¨ `storage/nankai_submissions/` ç›®å½•ï¼ŒJSONæ ¼å¼ï¼š

```json
{
  "timestamp": "20251201_143000",
  "level": "åˆçº§",
  "enterprise_info": {
    "enterprise_name": "ç¤ºä¾‹ä¼ä¸š",
    "contact_person": "å¼ ä¸‰",
    ...
  },
  "answers": {
    "1": "A. å·²å®Œæˆ",
    "2": "B. éƒ¨åˆ†å®Œæˆ",
    ...
  },
  "partial_details": {
    "2": "å·²å®ŒæˆåŸºæœ¬æ¶æ„ï¼Œä½†éƒ¨åˆ†ç»†èŠ‚å¾…å®Œå–„"
  },
  "score": {
    "total_score": 45.6,
    "max_score": 64.0,
    "percentage": 71.25,
    "details": {
      "1": {
        "max_score": 1.0,
        "earned_score": 1.0,
        "answer": "A. å·²å®Œæˆ"
      },
      "2": {
        "max_score": 2.0,
        "earned_score": 1.6,
        "answer": "B. éƒ¨åˆ†å®Œæˆ"
      }
    }
  },
  "submitted_at": "2025-12-01T14:30:00"
}
```

---

## âœ… åŠŸèƒ½éªŒè¯æ¸…å•

- [x] åç«¯æ­£ç¡®è¯»å–Excelé¢˜ç›®åˆ†å€¼
- [x] åç«¯æ­£ç¡®è®¡ç®—å®é™…å¾—åˆ†
- [x] åç«¯æ­£ç¡®è®¡ç®—ç™¾åˆ†åˆ¶å¾—åˆ†
- [x] åç«¯æ­£ç¡®è¿”å›æ‰€æœ‰åˆ†æ•°æ•°æ®
- [x] å‰ç«¯æ­£ç¡®ä¼ é€’åˆ†æ•°å‚æ•°
- [x] ç»“æœé¡µé¢æ­£ç¡®æ˜¾ç¤ºç™¾åˆ†åˆ¶å¾—åˆ†
- [x] ç»“æœé¡µé¢æ­£ç¡®æ˜¾ç¤ºå®é™…å¾—åˆ†å’Œæ»¡åˆ†
- [x] ç»“æœé¡µé¢æ­£ç¡®æ˜¾ç¤ºè¯„çº§
- [x] åˆ†æ•°æ•°æ®æ­£ç¡®ä¿å­˜åˆ°JSONæ–‡ä»¶
- [x] æœåŠ¡å™¨è‡ªåŠ¨é‡è½½æ–°ä»£ç 

---

## ğŸš€ ä½¿ç”¨æµç¨‹

1. **è®¿é—®é—®å·**ï¼šhttp://localhost:5000/nankai-survey
2. **é€‰æ‹©çº§åˆ«**ï¼šåˆçº§/ä¸­çº§/é«˜çº§
3. **å¡«å†™é—®å·**ï¼š
   - é€‰æ‹© A/B/C é€‰é¡¹
   - Bé€‰é¡¹éœ€å¡«å†™è¯¦ç»†è¯´æ˜
   - å¯ä¸Šä¼ ä½è¯ææ–™
4. **æäº¤é—®å·**ï¼šç³»ç»Ÿè‡ªåŠ¨è®¡ç®—åˆ†æ•°
5. **æŸ¥çœ‹ç»“æœ**ï¼š
   - æ˜¾ç¤ºç™¾åˆ†åˆ¶ç»¼åˆå¾—åˆ†ï¼ˆå¤§å­—å·ï¼‰
   - æ˜¾ç¤ºå®é™…å¾—åˆ†å’Œæ»¡åˆ†ï¼ˆå°å­—å·ï¼‰
   - æ˜¾ç¤ºè¯„çº§å’Œè¯„è¯­
   - æä¾›æŠ¥å‘Šç”Ÿæˆå…¥å£

---

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **åˆ†å€¼é…ç½®**ï¼šç¡®ä¿Excelæ–‡ä»¶ä¸­æœ‰"åˆ†å€¼"åˆ—
2. **æ•°æ®ç²¾åº¦**ï¼šæ‰€æœ‰åˆ†æ•°ä¿ç•™2ä½å°æ•°
3. **è¯„çº§é¢œè‰²**ï¼š
   - ä¼˜ç§€ï¼šç»¿è‰² (#28a745)
   - è‰¯å¥½ï¼šè“è‰² (#17a2b8)
   - ä¸­ç­‰ï¼šé»„è‰² (#ffc107)
   - åŠæ ¼ï¼šæ©™è‰² (#fd7e14)
   - éœ€æ”¹è¿›ï¼šçº¢è‰² (#dc3545)
4. **å…¼å®¹æ€§**ï¼šæ”¯æŒæ‰€æœ‰ç°ä»£æµè§ˆå™¨

---

## ğŸ‰ åŠŸèƒ½çŠ¶æ€

**âœ… ç™¾åˆ†åˆ¶å¾—åˆ†åŠŸèƒ½å·²å®Œæ•´å®ç°å¹¶æ­£å¸¸è¿è¡Œï¼**

æœåŠ¡å™¨åœ°å€ï¼šhttp://localhost:5000