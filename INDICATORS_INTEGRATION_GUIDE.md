# 南开大学指标体系集成指南

## 📋 概述

本指南说明如何将南开大学现代企业制度指数评价体系集成到问卷系统中，实现按用户类型和分级动态加载不同的问卷题目。

---

## 📁 文件说明

### 指标体系文件

**文件名**: `指标体系_备份.xlsx`

**来源**: 南开大学-现代企业制度指数评价体系初稿2025.10.22（单独指标）

**文件结构**:
- 共231道题目
- 10列数据
- 包含一级指标、二级指标、三级指标等信息

**列名**:
1. `序号` - 题目序号（1-231）
2. `一级指标` - 一级指标名称（9个）
3. `二级指标` - 二级指标名称
4. `三级指标` - 具体问题描述
5. `对应指引条目` - 对应的指引条目
6. `指标类型` - 合规项、有效项、调节项
7. `分值` - 题目分值
8. `适用对象` - 适用的企业类型
9. `自评分结果` - 自评分数（空）
10. `工商联评分结果` - 工商联评分（空）

---

## 🔄 题目分配逻辑

### 一级指标分类

系统中共有9个一级指标：

1. **党建引领** - 党建相关指标
2. **产权结构** - 产权和股权相关指标
3. **公司治理结构和机制** - 治理结构相关指标
4. **战略管理** - 战略规划相关指标
5. **内控、风险与合规管理** - 内控风险相关指标
6. **科学民主管理** - 民主管理相关指标
7. **科技创新** - 创新相关指标
8. **社会责任与企业文化** - 社会责任相关指标
9. **家族企业治理** - 家族企业相关指标

### 指标类型分类

系统将题目分为三种类型：

1. **合规项** (74道题)
   - 企业必须满足的基本要求
   - 分值: 0.5分

2. **有效项** (144道题)
   - 企业应该实施的有效措施
   - 分值: 0.5分

3. **调节项** (13道题)
   - 特殊的否决性指标
   - 分值: -10.0分

### 分级题目分配

#### 高级用户 (国家级、高级、高级专家)

- **题目总数**: 231道
- **包含类型**: 合规项、有效项、调节项
- **总分值**: -21.0分
- **适用**: 全面评估

#### 中级用户 (省级、中级、中级专家)

- **题目总数**: 218道
- **包含类型**: 合规项、有效项
- **总分值**: 98.5分
- **适用**: 标准评估

#### 初级用户 (市级、初级、初级专家)

- **题目总数**: 3道
- **包含类型**: 仅合规项
- **总分值**: 1.5分
- **重点领域**: 党建引领、产权结构、公司治理结构和机制
- **适用**: 基础评估

---

## 🔧 技术实现

### 配置文件

**文件**: `user_types_config_final.py`

**主要函数**:

```python
# 加载题目
def load_questions_from_excel(excel_path='指标体系_备份.xlsx'):
    """从Excel文件加载问卷题目"""
    
# 获取特定级别的题目
def get_questions_by_level(user_type, level, excel_path='指标体系_备份.xlsx'):
    """获取特定用户类型和分级的问卷题目"""
```

### 后端API

**端点**: `GET /api/get_questions`

**参数**:
- `user_type` (可选): 用户类型 (chamber_of_commerce, enterprise, expert)
- `user_level` (可选): 用户分级 (national, provincial, municipal, advanced, intermediate, beginner, senior, junior)

**响应**:
```json
{
    "success": true,
    "questions": [
        {
            "sequence": 1,
            "level1": "党建引领",
            "level2": "组织建设",
            "question": "党组织是否依法依规建立...",
            "question_type": "合规项",
            "base_score": 0.5,
            "applicable_enterprises": "所有企业"
        },
        ...
    ],
    "user_type": "enterprise",
    "user_level": "advanced",
    "total_questions": 231
}
```

---

## 📊 题目统计

### 按一级指标统计

| 一级指标 | 题目数 | 合规项 | 有效项 | 调节项 |
|---------|--------|--------|--------|--------|
| 党建引领 | 9 | 6 | 2 | 1 |
| 产权结构 | 29 | 18 | 11 | 0 |
| 公司治理结构和机制 | 41 | 13 | 25 | 3 |
| 战略管理 | 9 | 3 | 5 | 1 |
| 内控、风险与合规管理 | 31 | 12 | 16 | 3 |
| 科学民主管理 | 25 | 12 | 13 | 0 |
| 科技创新 | 18 | 4 | 14 | 0 |
| 社会责任与企业文化 | 38 | 6 | 32 | 5 |
| 家族企业治理 | 32 | 0 | 26 | 0 |
| **总计** | **231** | **74** | **144** | **13** |

### 按用户类型和分级统计

| 用户类型 | 分级 | 题目数 | 合规项 | 有效项 | 调节项 | 总分值 |
|---------|------|--------|--------|--------|--------|--------|
| 工商联 | 国家级 | 231 | 74 | 144 | 13 | -21.0 |
| 工商联 | 省级 | 218 | 74 | 144 | 0 | 98.5 |
| 工商联 | 市级 | 3 | 3 | 0 | 0 | 1.5 |
| 企业 | 高级 | 231 | 74 | 144 | 13 | -21.0 |
| 企业 | 中级 | 218 | 74 | 144 | 0 | 98.5 |
| 企业 | 初级 | 3 | 3 | 0 | 0 | 1.5 |
| 专家 | 高级 | 231 | 74 | 144 | 13 | -21.0 |
| 专家 | 中级 | 218 | 74 | 144 | 0 | 98.5 |
| 专家 | 初级 | 3 | 3 | 0 | 0 | 1.5 |

---

## 🚀 使用流程

### 1. 前端用户选择

```javascript
// 用户选择用户类型
const userType = 'enterprise';

// 用户选择分级
const userLevel = 'advanced';

// 调用API获取题目
fetch(`/api/get_questions?user_type=${userType}&user_level=${userLevel}`)
    .then(response => response.json())
    .then(data => {
        console.log(`获取了 ${data.total_questions} 道题目`);
    });
```

### 2. 后端处理

```python
# 后端接收请求
user_type = request.args.get('user_type')
user_level = request.args.get('user_level')

# 加载对应的题目
questions = get_questions_by_level(user_type, user_level, '指标体系_备份.xlsx')

# 返回题目
return jsonify({
    'success': True,
    'questions': questions,
    'total_questions': len(questions)
})
```

### 3. 前端渲染

```javascript
// 渲染题目
questions.forEach((question, index) => {
    console.log(`${index + 1}. [${question.question_type}] ${question.question}`);
});
```

---

## 📝 题目示例

### 高级用户示例

**题目1**: 党组织是否依法依规建立...
- **类型**: 合规项
- **分值**: 0.5分
- **一级指标**: 党建引领
- **二级指标**: 组织建设

**题目2**: 党组织是否存在引导和监督企业遵守法律法规的行为
- **类型**: 有效项
- **分值**: -10.0分
- **一级指标**: 党建引领
- **二级指标**: 政治引领

### 初级用户示例

**题目1**: 党组织是否依法依规建立...
- **类型**: 合规项
- **分值**: 0.5分
- **一级指标**: 党建引领

**题目2**: 企业的工商登记信息是否与实际出资情况保持一致？
- **类型**: 合规项
- **分值**: 0.5分
- **一级指标**: 产权结构

**题目3**: 公司所有股东的各项权利是否都能得到保障？
- **类型**: 合规项
- **分值**: 0.5分
- **一级指标**: 公司治理结构和机制

---

## 🔍 常见问题

### Q1: 为什么初级用户只有3道题目？

**A**: 初级用户的问卷设计为基础评估，只包含核心领域（党建引领、产权结构、公司治理结构和机制）的合规项。这样可以让初级用户快速完成问卷，同时关注最重要的指标。

### Q2: 如何添加更多的初级题目？

**A**: 修改 `user_types_config_final.py` 中的 `focus_areas` 配置，添加更多的一级指标：

```python
'focus_areas': [
    '党建引领', 
    '产权结构', 
    '公司治理结构和机制',
    '科学民主管理',
    '战略管理'  # 添加新的领域
]
```

### Q3: 如何自定义分级题目？

**A**: 修改 `load_questions_from_excel()` 函数中的题目分配逻辑，或者在 `get_questions_by_level()` 函数中添加自定义的过滤规则。

### Q4: 指标体系文件可以更新吗？

**A**: 可以。只需将新的Excel文件保存为 `指标体系_备份.xlsx`，系统会自动加载新的题目。

---

## 🔧 配置修改

### 修改分级题目数量

编辑 `user_types_config_final.py` 中的 `focus_areas`:

```python
'beginner': {
    'description': '企业初级自评问卷 - 基础自评',
    'include_all': False,
    'question_types': ['合规项'],
    'applicable_enterprises': ['所有企业'],
    'focus_areas': [
        '党建引领', 
        '产权结构', 
        '公司治理结构和机制', 
        '科学民主管理'  # 添加更多领域
    ]
}
```

### 修改题目类型

编辑 `user_types_config_final.py` 中的 `question_types`:

```python
'intermediate': {
    'description': '企业中级自评问卷 - 标准自评',
    'include_all': True,
    'question_types': ['合规项', '有效项', '调节项'],  # 添加调节项
    'applicable_enterprises': ['所有企业']
}
```

---

## 📊 性能指标

- **题目加载时间**: ~300-500ms
- **缓存命中率**: 100%（第一次加载后）
- **内存占用**: ~[object Object]最佳实践

1. **定期更新指标体系** - 根据最新的评价体系更新Excel文件
2. **缓存题目数据** - 使用全局缓存避免重复加载
3. **验证题目完整性** - 定期检查题目是否完整加载
4. **监控加载性能** - 记录题目加载时间

---

## 📞 支持

如有问题，请：
1. 查看本指南
2. 查看 `analyze_questions_by_level.py` 脚本的输出
3. 查看后端日志
4. 联系系统管理员

---

## 📝 版本历史

### v1.0 (2025-11-23)

- 初始版本
- 支持南开大学指标体系集成
- 实现按用户类型和分级加载题目

---

**集成完成！系统现在支持南开大学现代企业制度指数评价体系。**

