# 企业评价系统使用说明

## 一、系统简介

本系统基于南开大学现代企业制度指数评价体系，提供企业治理水平评价服务。包含231个评价指标，覆盖9个核心维度，自动生成Word和PDF专业评价报告。

## 二、快速启动

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置邮箱（首次使用）
编辑 `config.json` 文件：
```json
{
    "email": {
        "smtp_server": "smtp.qq.com",
        "smtp_port": 587,
        "username": "你的QQ邮箱@qq.com",
        "password": "QQ邮箱授权码(16位)",
        "from_name": "企业评价系统",
        "use_tls": true
    }
}
```

**获取QQ邮箱授权码：**
1. 登录 mail.qq.com → 设置 → 账户
2. 找到"POP3/SMTP服务" → 开启
3. 生成授权码（16位字符）
4. 填入配置文件

### 3. 启动系统
```bash
python app.py
```

访问: http://localhost:5000

## 三、使用方式

### 方式一：在线问卷提交（推荐）

**适用场景：** 企业在线填写问卷，系统自动生成报告并发送

**操作步骤：**
1. 访问系统首页 → 点击"在线填写问卷"
2. 填写企业基本信息和231个评价问题
3. 提交后系统自动生成Word和PDF报告
4. 报告自动发送到填写的企业邮箱

**优点：**
- 实时进度显示
- 支持暂存草稿
- 自动计算得分
- 邮件自动送达

### 方式二：批量Excel导入

**适用场景：** 已有Excel格式的企业数据，需要批量生成报告

**操作步骤：**
1. 访问系统首页 → 点击"批量上传企业信息"
2. 下载Excel模板
3. 按模板填写企业数据
4. 上传Excel文件
5. 系统批量生成报告并发送邮件

### 方式三：终端管理工具

**适用场景：** 管理员批量处理在线提交的问卷

**操作步骤：**
```bash
python manage_submissions.py
```

**功能菜单：**
- `1` - 查看所有提交记录
- `2` - 生成Word报告（指定企业）
- `3` - 生成PDF报告（指定企业）
- `4` - 批量生成报告并发邮件
- `5` - 查看提交详情
- `0` - 退出

### 方式四：命令行工具

**适用场景：** 单个企业问卷生成报告

**操作步骤：**
```bash
python main.py
```

**功能菜单：**
- `1` - 生成空白问卷（Excel格式）
- `2` - 生成Word评价报告
- `3` - 生成PDF评价报告
- `4` - 生成综合分析报告
- `0` - 退出

## 四、评价体系说明

### 评价维度（9个）
1. **党建引领** - 党组织建设和作用发挥
2. **产权结构** - 股权结构和产权保护
3. **公司治理** - 治理架构和决策机制
4. **战略管理** - 战略规划和执行
5. **内控风险** - 内控体系和风险管理
6. **科学民主** - 管理民主化和科学化
7. **科技创新** - 创新能力和研发投入
8. **社会责任** - 企业文化和社会责任
9. **家族治理** - 家族企业特殊治理

### 评价等级
- **A级（优秀）** - 得分率 ≥ 90%
- **B级（良好）** - 得分率 80-90%
- **C级（中等）** - 得分率 70-80%
- **D级（及格）** - 得分率 60-70%
- **E级（需改进）** - 得分率 < 60%

### 指标类型
1. **合规类** - 是/否判断（是=满分，否=0分）
2. **有效性类** - 五级评分（很有效=100%，一般=60%，完全无效=0%）
3. **一票否决类** - 负分项（违反扣分）

## 五、报告说明

### Word报告内容
- 封面和目录
- 执行摘要
- 企业基本信息
- 评价结果总览（含雷达图）
- 各维度详细分析
- 问题清单
- 改进建议
- 得分明细附录

### PDF报告内容（专业版）
- 精美封面
- 目录导航
- 执行摘要
- 企业基本情况
- 评价概览与图表
- 维度分析表
- 详细评价结果
- 风险评估与预警
- 改进路径规划
- 合规性检查清单
- 报告说明与附录

## 六、文件结构

```
enterprise_report_system/
├── app.py                          # Web应用主程序
├── main.py                         # 命令行工具
├── manage_submissions.py           # 终端管理工具
├── config.json                     # 系统配置
├── requirements.txt                # Python依赖
├── 指标体系.xlsx                   # 评价指标体系
├── templates/                      # HTML模板
│   ├── index.html                  # 首页
│   ├── questionnaire.html          # 在线问卷
│   ├── success.html                # 提交成功页
│   └── upload.html                 # 批量上传页
├── submissions/                    # 在线提交数据
│   ├── *.json                      # 提交备份
│   └── 问卷_*.xlsx                 # 已填写问卷
├── reports/                        # 生成的报告
└── uploads/                        # 上传的文件

```

## 七、常见问题

### Q1: 为什么收不到邮件？
**A:** 检查以下几点：
1. `config.json` 中的邮箱配置是否正确
2. QQ邮箱授权码是否正确（16位）
3. 是否开启了SMTP服务
4. 检查垃圾邮件箱

### Q2: 如何修改评价指标？
**A:** 编辑 `指标体系.xlsx` 文件，按以下格式：
- 序号、一级指标、二级指标、三级指标（问题）
- 指标类型、分值、适用对象

### Q3: 报告生成失败怎么办？
**A:**
1. 查看终端错误信息
2. 确认已安装所有依赖：`pip install -r requirements.txt`
3. 检查问卷是否完整填写
4. 查看系统日志

### Q4: 能否自定义报告格式？
**A:** 可以，修改以下文件：
- Word报告：`enterprise_report_generator.py`
- PDF报告：`pdf_report_generator.py`

### Q5: 支持哪些企业类型？
**A:**
- 有限责任公司
- 股份有限公司
- 国有企业
- 民营企业
- 家族企业

### Q6: 数据存储在哪里？
**A:**
- 在线提交：`submissions/` 文件夹
- 生成报告：`reports/` 文件夹
- 批量上传：`uploads/` 文件夹

## 八、技术支持

遇到问题请提供以下信息：
1. 系统版本和Python版本
2. 完整的错误信息
3. 操作步骤描述
4. 相关截图

---

**版本：** v2.0
**更新日期：** 2025-11-17
**技术栈：** Python 3.x + Flask + ReportLab + python-docx
