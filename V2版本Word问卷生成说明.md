# V2版本Word问卷生成说明（最终版）

## ✅ 已按照参考文件格式完成！

V2版本现在完全按照"调查问卷--初级.docx"参考文件的格式生成Word问卷！

## 📁 最新生成的文件

### 最终版本（2025-12-01 17:18:22）

```
survey_generator/output/questionnaires/
├── 调查问卷_初级_20251201_171822.docx  ✅ 64题完整
├── 调查问卷_中级_20251201_171822.docx  ✅ 52题完整
└── 调查问卷_高级_20251201_171822.docx  ✅ 42题完整
```

## 📋 表格格式（6列）

完全按照参考文件格式：

| 序号 | 一级指标 | 二级指标 | 三级指标 | 选项 | 补充数据 / 说明 |
|------|----------|----------|----------|------|----------------|
| 1 | 治理方向性 | 党组织建设 | 规范党组织建设 | A. 有 3 名以上正式党员并单独成立党组织 B. 暂不具备单独组建条件，已联合组建区域性 / 行业性党组织 C. 未组建党组织 | 党员人数：______人（仅 A/B 选项填写） |

## 🎯 核心特点

### 1. **6列表格结构**
- 序号
- 一级指标
- 二级指标
- 三级指标
- **选项**（从打分标准转换而来）
- 补充数据 / 说明

### 2. **智能选项转换**
将Excel中的"打分标准"自动转换为简化的ABC选项格式：

**Excel原始数据**：
```
打分标准：完成以下对应条件的得1分
1.有三名以上正式党员的企业，根据上级党组织要求成立党在企业的基层组织；
2.暂不具备单独组建党组织条件的，联合组建区域性党组织、行业性党组织。
```

**Word中的选项**：
```
A. 有 3 名以上正式党员并单独成立党组织
B. 暂不具备单独组建条件，已联合组建区域性 / 行业性党组织
C. 未组建党组织
```

### 3. **自动提取填空项**
从打分标准中智能识别需要填写的数据项：

| 识别内容 | 生成的填空项 |
|---------|-------------|
| 党员人数 | 党员人数：______人（仅 A/B 选项填写） |
| 会议次数 | 上一年度支部党员大会召开次数：______次；支委会：______次... |
| 经费场所 | 上一年度党组织活动经费金额：元；活动场所面积：㎡ |
| 认同度调查 | 参与认同度调查员工人数：______人；认同人数：人；认同度：% |
| 培训信息 | 管理层法治培训年度次数：______次；培训时长：______小时 |

### 4. **完整的企业基本信息**
每个问卷都包含：
- 制表时间
- 企业主营业务
- 企业规模
- 是否为民营企业500强
- 企业成立年限
- 上一年度营业收入
- 上一年度研发投入

## 🔄 与参考文件的对比

| 特性 | 参考文件 | V2生成的文档 | 状态 |
|------|---------|-------------|------|
| 表格列数 | 6列 | 6列 | ✅ 一致 |
| 选项格式 | 简化的ABC选项 | 简化的ABC选项 | ✅ 一致 |
| 填空项位置 | 补充数据/说明列 | 补充数据/说明列 | ✅ 一致 |
| 企业基本信息 | 完整 | 完整 | ✅ 一致 |
| 按一级指标分组 | 是 | 是 | ✅ 一致 |
| 题目数量 | 64题（初级） | 64题（初级） | ✅ 一致 |

## 📊 数据完整性

| 级别 | Excel指标数 | Word题目数 | 状态 |
|------|------------|-----------|------|
| 初级 | 64条 | 64题 | ✅ 完全对应 |
| 中级 | 52条 | 52题 | ✅ 完全对应 |
| 高级 | 42条 | 42题 | ✅ 完全对应 |

## 🔄 如何使用

### 重新生成Word问卷
```bash
python generate_word_questionnaires_v2.py
```

### 修改指标后更新
1. 修改 `nankai_indicators.xlsx`
2. 运行 `python generate_word_questionnaires_v2.py`
3. 查看新生成的Word文档（带新时间戳）

## ✨ 智能转换示例

### 示例1：党组织建设
**Excel打分标准**：
```
评分标准：完成以下对应条件的得1分
1.有三名以上正式党员的企业...
2.暂不具备单独组建党组织条件...
```

**Word选项**：
```
A. 有 3 名以上正式党员并单独成立党组织
B. 暂不具备单独组建条件，已联合组建区域性 / 行业性党组织
C. 未组建党组织
```

**补充数据**：
```
党员人数：______人（仅 A/B 选项填写）
```

### 示例2：组织生活制度
**Excel打分标准**：
```
评分标准：以下全部完成得1分，少完成不得分
1.每三个月至少召开一次支部党员大会；
2.每个月至少召开一次党支部委员会；
3.每个月至少召开一次党小组会；
4.每个月至少召开一次党课。
```

**Word选项**：
```
A. 全部按要求开展（每季度 1 次支部党员大会 + 每月 1 次支委会 / 党小组会 / 党课）
B. 未完全按要求开展
```

**补充数据**：
```
上一年度支部党员大会召开次数：______次；支委会：______次；党小组会：______次；党课：______次
```

## 🎨 格式特点

1. **标题居中**：民营企业现代企业制度指数评价调查问卷
2. **级别标题**：初级指标评价问卷（基础指标）
3. **一级指标分组**：每个一级指标单独成表
4. **字体统一**：宋体
5. **表格边框**：完整边框
6. **对齐方式**：序号居中，其他左对齐

## 📝 关键改进

### V2版本的演进

**第一版**（已废弃）：
- ❌ 7列表格
- ❌ 显示原始打分标准
- ❌ 格式不符合参考文件

**第二版**（当前版本）：
- ✅ 6列表格
- ✅ 智能转换选项
- ✅ 完全符合参考文件格式
- ✅ 自动提取填空项

## 🎯 总结

**V2版本现在完全按照参考文件格式生成Word问卷！**

- ✅ 6列表格结构
- ✅ 智能选项转换
- ✅ 自动提取填空项
- ✅ 完整的企业基本信息
- ✅ 与Excel数据完全对应
- ✅ 格式与参考文件一致

**只需一个命令**：`python generate_word_questionnaires_v2.py`

所有题目都会按照参考文件的格式完整生成！

---

**生成时间**: 2025-12-01 17:18:22  
**版本**: V2（最终版）  
**参考文件**: 调查问卷--初级.docx  
**状态**: ✅ 完全符合参考格式