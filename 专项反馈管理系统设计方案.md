# 专项反馈管理系统设计方案

## 一、需求分析

### 1. 功能需求
对企业反馈的问题进行分类查看和深度分析，支持多维度的反馈数据管理和分析。

### 2. 反馈类型分类
```
专项反馈
├── 典型案例
│   ├── 党建
│   ├── 文化建设
│   ├── 社会责任
│   ├── 创新发展
│   ├── 人才培养
│   └── 其他
├── 问题意见反馈
│   ├── 经营问题
│   ├── 管理问题
│   ├── 技术问题
│   └── 其他问题
├── 工商联反馈
│   ├── 政策建议
│   ├── 服务评价
│   ├── 合作建议
│   └── 其他反馈
├── 专家评价反馈
│   ├── 技术评价
│   ├── 管理评价
│   ├── 发展评价
│   └── 其他评价
└── 自评报告佐证材料
    ├── 财务报表
    ├── 荣誉证书
    ├── 项目成果
    └── 其他材料
```

---

## 二、数据库设计

### 1. 专项反馈表 (special_feedbacks)
```sql
CREATE TABLE special_feedbacks (
  id VARCHAR(36) PRIMARY KEY,
  enterprise_id VARCHAR(36) NOT NULL,
  enterprise_name VARCHAR(100),
  
  -- 反馈分类
  category VARCHAR(50) NOT NULL,  -- 反馈类型
  subcategory VARCHAR(50),        -- 子分类
  
  -- 内容信息
  title VARCHAR(200) NOT NULL,
  content TEXT,
  
  -- 附件
  attachments JSON,               -- 附件列表
  file_count INT DEFAULT 0,
  
  -- 状态和评分
  status ENUM('draft', 'submitted', 'reviewing', 'approved', 'rejected') DEFAULT 'draft',
  rating INT,                     -- 评分 (1-5)
  
  -- 时间信息
  submitted_at TIMESTAMP,
  reviewed_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  -- 审核信息
  reviewer_id VARCHAR(36),
  reviewer_name VARCHAR(50),
  review_comment TEXT,
  
  -- 其他
  tags JSON,                      -- 标签
  priority ENUM('low', 'medium', 'high', 'urgent') DEFAULT 'medium',
  remark TEXT,
  
  INDEX idx_enterprise_id (enterprise_id),
  INDEX idx_category (category),
  INDEX idx_status (status),
  INDEX idx_submitted_at (submitted_at)
);
```

### 2. 反馈分析表 (feedback_analysis)
```sql
CREATE TABLE feedback_analysis (
  id VARCHAR(36) PRIMARY KEY,
  feedback_id VARCHAR(36) NOT NULL,
  
  -- 分析维度
  dimension VARCHAR(50),          -- 分析维度
  metric_name VARCHAR(100),       -- 指标名称
  metric_value DECIMAL(10, 2),    -- 指标值
  
  -- 分析结果
  analysis_type VARCHAR(50),      -- 分析类型
  analysis_result TEXT,           -- 分析结果
  
  -- 时间
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  
  INDEX idx_feedback_id (feedback_id),
  INDEX idx_dimension (dimension)
);
```

### 3. 反馈统计表 (feedback_statistics)
```sql
CREATE TABLE feedback_statistics (
  id VARCHAR(36) PRIMARY KEY,
  
  -- 统计维度
  stat_date DATE,
  stat_type VARCHAR(50),          -- 统计类型
  
  -- 统计数据
  total_count INT DEFAULT 0,
  category_breakdown JSON,        -- 分类统计
  status_breakdown JSON,          -- 状态统计
  rating_distribution JSON,       -- 评分分布
  
  -- 趋势数据
  trend_data JSON,                -- 趋势数据
  
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  UNIQUE KEY uk_date_type (stat_date, stat_type)
);
```

### 4. 反馈标签表 (feedback_tags)
```sql
CREATE TABLE feedback_tags (
  id VARCHAR(36) PRIMARY KEY,
  tag_name VARCHAR(50) NOT NULL,
  tag_category VARCHAR(50),
  usage_count INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  
  UNIQUE KEY uk_tag_name (tag_name)
);
```

### 5. 反馈关联表 (feedback_relations)
```sql
CREATE TABLE feedback_relations (
  id VARCHAR(36) PRIMARY KEY,
  source_feedback_id VARCHAR(36),
  related_feedback_id VARCHAR(36),
  relation_type VARCHAR(50),      -- 关系类型
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  
  INDEX idx_source (source_feedback_id),
  INDEX idx_related (related_feedback_id)
);
```

---

## 三、反馈分类详解

### 1. 典型案例 (Typical Cases)
**目的**: 展示企业的成功经验和最佳实践

**子分类**:
- **党建** (Party Building)
  - 党组织建设
  - 党员发展
  - 党建活动
  - 廉政建设

- **文化建设** (Culture)
  - 企业文化
  - 品牌建设
  - 文化活动
  - 文化传承

- **社会责任** (Social Responsibility)
  - 环保措施
  - 社区贡献
  - 慈善活动
  - 员工福利

- **创新发展** (Innovation)
  - 技术创新
  - 产品创新
  - 管理创新
  - 商业模式创新

- **人才培养** (Talent Development)
  - 人才引进
  - 培训计划
  - 职业发展
  - 人才激励

**字段**:
```json
{
  "case_type": "典型案例",
  "subcategory": "党建",
  "title": "党建引领企业发展",
  "description": "详细描述",
  "results": "取得的成果",
  "lessons_learned": "经验教训",
  "attachments": ["证书.pdf", "照片.jpg"]
}
```

### 2. 问题意见反馈 (Issues & Suggestions)
**目的**: 收集企业遇到的问题和改进建议

**子分类**:
- **经营问题** (Business Issues)
  - 市场问题
  - 销售困难
  - 成本压力
  - 融资困难

- **管理问题** (Management Issues)
  - 人力资源
  - 流程优化
  - 制度完善
  - 团队建设

- **技术问题** (Technical Issues)
  - 技术难题
  - 设备问题
  - 工艺改进
  - 信息化建设

- **其他问题** (Other Issues)
  - 政策建议
  - 环境问题
  - 其他困难

**字段**:
```json
{
  "issue_type": "问题意见反馈",
  "subcategory": "经营问题",
  "title": "市场竞争压力大",
  "description": "详细描述问题",
  "impact": "问题影响",
  "expected_solution": "期望解决方案",
  "urgency": "urgent"
}
```

### 3. 工商联反馈 (Chamber Feedback)
**目的**: 工商联对企业的评价和建议

**子分类**:
- **政策建议** (Policy Suggestions)
  - 产业政策
  - 发展建议
  - 政策解读
  - 政策支持

- **服务评价** (Service Evaluation)
  - 服务质量
  - 服务改进
  - 服务满意度
  - 服务建议

- **合作建议** (Cooperation Suggestions)
  - 合作机会
  - 资源对接
  - 联合项目
  - 战略合作

- **其他反馈** (Other Feedback)
  - 发展评价
  - 行业地位
  - 其他建议

**字段**:
```json
{
  "feedback_type": "工商联反馈",
  "subcategory": "政策建议",
  "title": "关于产业升级的建议",
  "content": "详细内容",
  "reviewer_id": "reviewer_001",
  "reviewer_name": "张三",
  "rating": 4
}
```

### 4. 专家评价反馈 (Expert Evaluation)
**目的**: 专家对企业的专业评价

**子分类**:
- **技术评价** (Technical Evaluation)
  - 技术水平
  - 创新能力
  - 工艺水平
  - 产品质量

- **管理评价** (Management Evaluation)
  - 管理体系
  - 组织结构
  - 流程管理
  - 制度建设

- **发展评价** (Development Evaluation)
  - 发展潜力
  - 竞争力
  - 市场前景
  - 战略规划

- **其他评价** (Other Evaluation)
  - 综合评价
  - 其他方面

**字段**:
```json
{
  "evaluation_type": "专家评价反馈",
  "subcategory": "技术评价",
  "expert_name": "李四",
  "expert_field": "技术领域",
  "evaluation_content": "详细评价",
  "score": 85,
  "recommendations": "改进建议"
}
```

### 5. 自评报告佐证材料 (Self-evaluation Supporting Materials)
**目的**: 企业自评报告的支撑材料

**子分类**:
- **财务报表** (Financial Statements)
  - 资产负债表
  - 利润表
  - 现金流量表
  - 财务分析

- **荣誉证书** (Honors & Certificates)
  - 行业奖项
  - 资质认证
  - 荣誉称号
  - 专利证书

- **项目成果** (Project Results)
  - 研发成果
  - 产品成果
  - 项目案例
  - 成果展示

- **其他材料** (Other Materials)
  - 政府支持
  - 媒体报道
  - 合作协议
  - 其他证明

**字段**:
```json
{
  "material_type": "自评报告佐证材料",
  "subcategory": "财务报表",
  "material_name": "2024年财务报表",
  "file_url": "path/to/file.pdf",
  "description": "详细描述",
  "verification_status": "verified"
}
```

---

## 四、深度分析功能

### 1. 多维度分析

#### 1.1 分类分析
```
分析维度: 反馈类型分布
┌─────────────────────────────┐
│ 典型案例:      25%  (50条)  │
│ 问题反馈:      35%  (70条)  │
│ 工商联反馈:    20%  (40条)  │
│ 专家评价:      15%  (30条)  │
│ 佐证材料:      5%   (10条)  │
└─────────────────────────────┘
```

#### 1.2 时间趋势分析
```
分析维度: 反馈提交趋势
┌─────────────────────────────┐
│ 1月:  10条  ▁
│ 2月:  15条  ▂
│ 3月:  20条  ▃
│ 4月:  25条  ▄
│ 5月:  30条  ▅
│ 6月:  35条  ▆
└─────────────────────────────┘
```

#### 1.3 评分分析
```
分析维度: 反馈评分分布
┌─────────────────────────────┐
│ 5星: ████████░░ 40%
│ 4星: ██████░░░░ 30%
│ 3星: ████░░░░░░ 20%
│ 2星: ██░░░░░░░░ 7%
│ 1星: █░░░░░░░░░ 3%
└─────────────────────────────┘
```

#### 1.4 状态分析
```
分析维度: 反馈处理状态
┌─────────────────────────────┐
│ 已批准:  60条  (60%)
│ 审核中:  20条  (20%)
│ 已驳回:  10条  (10%)
│ 草稿:    10条  (10%)
└─────────────────────────────┘
```

### 2. 关键指标分析

#### 2.1 反馈质量指标
```
指标名称           | 计算方法              | 目标值
─────────────────────────────────────────────
平均评分           | 所有评分/反馈总数     | ≥ 3.5
批准率             | 批准数/总数           | ≥ 80%
平均处理时间       | 总处理时间/反馈数     | ≤ 5天
高优先级比例       | 高优先级/总数         | ≤ 20%
```

#### 2.2 企业反馈指标
```
指标名称           | 计算方法              | 说明
─────────────────────────────────────────────
反馈活跃度         | 企业反馈数/月         | 反映企业参与度
反馈质量评分       | 平均评分              | 反映反馈质量
问题解决率         | 解决问题数/总问题数   | 反映问题处理效果
```

### 3. 对标分析

#### 3.1 行业对标
```
企业A vs 行业平均
┌────────────────────────────┐
│ 反馈数量:  150 vs 120 ↑
│ 平均评分:  4.2 vs 3.8 ↑
│ 批准率:    85% vs 75% ↑
│ 问题解决率: 90% vs 70% ↑
└────────────────────────────┘
```

#### 3.2 地区对标
```
北京市 vs 全国平均
┌────────────────────────────┐
│ 反馈数量:  500 vs 450
│ 平均评分:  4.1 vs 3.9
│ 批准率:    82% vs 78%
└────────────────────────────┘
```

### 4. 问题分析

#### 4.1 问题聚类
```
常见问题分类:
┌────────────────────────────┐
│ 市场竞争压力:  25条 (35%)
│ 融资困难:      15条 (21%)
│ 人才短缺:      12条 (17%)
│ 技术瓶颈:      10条 (14%)
│ 其他:          10条 (13%)
└────────────────────────────┘
```

#### 4.2 问题关联分析
```
问题关联关系:
市场竞争 ──→ 融资困难
   ↓         ↓
人才短缺 ←── 技术瓶颈
```

### 5. 趋势预测

#### 5.1 反馈量预测
```
未来3个月反馈量预测:
7月: 40条 (±5)
8月: 45条 (±5)
9月: 50条 (±5)
```

#### 5.2 问题趋势预测
```
问题类型趋势:
- 市场问题: 上升趋势 ↑
- 融资问题: 稳定趋势 →
- 技术问题: 下降趋势 ↓
```

---

## 五、API 接口设计

### 5.1 反馈管理接口

#### 获取反馈列表
```
GET /api/portal/chamber/feedbacks
Query Parameters:
  - category: 反馈类型
  - subcategory: 子分类
  - status: 状态
  - enterprise_id: 企业ID
  - date_from: 开始日期
  - date_to: 结束日期
  - page: 页码
  - limit: 每页数量

Response:
{
  "success": true,
  "data": {
    "total": 200,
    "page": 1,
    "limit": 20,
    "feedbacks": [
      {
        "id": "uuid",
        "enterprise_name": "企业A",
        "category": "典型案例",
        "subcategory": "党建",
        "title": "党建引领企业发展",
        "status": "approved",
        "rating": 4,
        "submitted_at": "2024-01-01T00:00:00Z"
      }
    ]
  }
}
```

#### 创建反馈
```
POST /api/portal/chamber/feedbacks
Body:
{
  "enterprise_id": "ent_001",
  "category": "典型案例",
  "subcategory": "党建",
  "title": "党建引领企业发展",
  "content": "详细内容",
  "attachments": ["file1.pdf", "file2.jpg"],
  "tags": ["党建", "发展"],
  "priority": "high"
}
```

#### 更新反馈
```
PUT /api/portal/chamber/feedbacks/:id
Body:
{
  "title": "更新后的标题",
  "content": "更新后的内容",
  "status": "submitted"
}
```

#### 删除反馈
```
DELETE /api/portal/chamber/feedbacks/:id
```

### 5.2 分析接口

#### 获取分类分析
```
GET /api/portal/chamber/feedbacks/analysis/category
Query Parameters:
  - date_from: 开始日期
  - date_to: 结束日期

Response:
{
  "success": true,
  "data": {
    "total": 200,
    "categories": {
      "典型案例": 50,
      "问题反馈": 70,
      "工商联反馈": 40,
      "专家评价": 30,
      "佐证材料": 10
    },
    "percentage": {
      "典型案例": 25,
      "问题反馈": 35,
      "工商联反馈": 20,
      "专家评价": 15,
      "佐证材料": 5
    }
  }
}
```

#### 获取时间趋势
```
GET /api/portal/chamber/feedbacks/analysis/trend
Query Parameters:
  - period: day/week/month
  - date_from: 开始日期
  - date_to: 结束日期

Response:
{
  "success": true,
  "data": {
    "trend": [
      { "date": "2024-01-01", "count": 10 },
      { "date": "2024-01-02", "count": 15 },
      ...
    ]
  }
}
```

#### 获取评分分析
```
GET /api/portal/chamber/feedbacks/analysis/rating
Query Parameters:
  - date_from: 开始日期
  - date_to: 结束日期

Response:
{
  "success": true,
  "data": {
    "average_rating": 3.8,
    "distribution": {
      "5": 40,
      "4": 30,
      "3": 20,
      "2": 7,
      "1": 3
    }
  }
}
```

#### 获取关键指标
```
GET /api/portal/chamber/feedbacks/analysis/metrics
Query Parameters:
  - date_from: 开始日期
  - date_to: 结束日期

Response:
{
  "success": true,
  "data": {
    "total_feedbacks": 200,
    "average_rating": 3.8,
    "approval_rate": 0.85,
    "avg_processing_time": 3.5,
    "high_priority_ratio": 0.15
  }
}
```

#### 获取问题分析
```
GET /api/portal/chamber/feedbacks/analysis/issues
Query Parameters:
  - date_from: 开始日期
  - date_to: 结束日期

Response:
{
  "success": true,
  "data": {
    "total_issues": 70,
    "issues": [
      {
        "category": "经营问题",
        "count": 25,
        "percentage": 35,
        "subcategories": {
          "市场竞争": 15,
          "融资困难": 10
        }
      }
    ]
  }
}
```

---

## 六、前端界面设计

### 6.1 反馈列表页面
- 反馈类型筛选
- 状态筛选
- 日期范围筛选
- 搜索功能
- 表格显示（分类、标题、企业、状态、评分、日期）
- 分页控制
- 操作按钮（查看、编辑、删除、审核）

### 6.2 反馈详情页面
- 基本信息展示
- 内容展示
- 附件列表
- 审核信息
- 评分显示
- 相关反馈推荐

### 6.3 深度分析页面
- 分类分析图表
- 时间趋势图表
- 评分分布图表
- 状态分析图表
- 关键指标卡片
- 问题分析表格
- 对标分析对比

### 6.4 新增/编辑反馈页面
- 反馈类型选择
- 子分类选择
- 标题输入
- 内容编辑
- 附件上传
- 标签选择
- 优先级设置

---

## 七、业务流程

### 7.1 反馈提交流程
```
企业填写反馈
    ↓
选择分类和子分类
    ↓
上传附件
    ↓
提交反馈
    ↓
系统自动分配
    ↓
审核员审核
    ↓
批准/驳回
    ↓
反馈完成
```

### 7.2 反馈审核流程
```
反馈提交
    ↓
初审（检查完整性）
    ↓
内容审核
    ↓
评分
    ↓
批准/驳回
    ↓
反馈给企业
```

### 7.3 分析流程
```
收集反馈数据
    ↓
数据清洗和标准化
    ↓
多维度分析
    ↓
生成分析报告
    ↓
导出和分享
```

---

## 八、安全考虑

### 8.1 数据安全
- 敏感信息加密存储
- 访问权限控制
- 操作日志记录
- 定期数据备份

### 8.2 权限控制
- 企业只能查看自己的反馈
- 审核员可以查看分配的反馈
- 管理员可以查看所有反馈
- 分析数据脱敏处理

### 8.3 文件安全
- 文件类型检查
- 文件大小限制
- 病毒扫描
- 加密存储

---

## 九、实现优先级

### Phase 1（必须）
- [ ] 反馈表设计
- [ ] 基本CRUD接口
- [ ] 反馈列表页面
- [ ] 新增/编辑页面
- [ ] 分类分析接口

### Phase 2（重要）
- [ ] 深度分析功能
- [ ] 时间趋势分析
- [ ] 关键指标分析
- [ ] 问题分析
- [ ] 分析报告生成

### Phase 3（优化）
- [ ] 对标分析
- [ ] 趋势预测
- [ ] 数据导出
- [ ] 高级搜索

### Phase 4（扩展）
- [ ] 移动端支持
- [ ] API文档自动生成
- [ ] 单元测试
- [ ] 性能优化

---

## 十、测试用例

### 测试场景
1. 创建不同类型的反馈
2. 编辑反馈信息
3. 删除反馈
4. 反馈审核流程
5. 分类分析准确性
6. 时间趋势分析
7. 评分分布分析
8. 问题聚类分析
9. 权限控制
10. 文件上传和下载


